<!DOCTYPE html><head><title>LittleDarwin Aggregate Mutation Report</title> <style type='text/css'> body { font-family: "Carlito", "Calibri", "Helvetica Neue", sans-serif;}
                    .code { font-family: monospace; font-size: medium; }
                    .methodLine { background: white; }
                    .outsideLine { background: lightgray; } 
                    .tooltip { position: relative; display: inline-block; }
                    .tooltip .tooltiptext { visibility: hidden; display: block;
                        background-color: #006400; color: #ffffff; text-align: left;
                        border-radius: 0.3em; padding: 0.5em 0.5em; position: absolute; top: 125%; z-index: 200;}
                    .tooltip:hover .tooltiptext { visibility: visible; } .GenericTraditionalMutationOperator { background: #FFFFF0; } .ArithmeticOperatorReplacementBinary { background: #FFB6C1; } .ConditionalOperatorDeletion { background: #FFD700; } .NullifyInputVariable { background: #90EE90; } .ArithmeticOperatorReplacementUnary { background: #DDA0DD; } .NullifyReturnValue { background: #E0FFFF; } .AssignmentOperatorReplacementShortcut { background: #B0C4DE; } .NullifyObjectInitialization { background: #F08080; } .LogicalOperatorReplacement { background: #F0E68C; } .RemoveNullCheck { background: #ADD8E6; } .ConditionalOperatorReplacement { background: #87CEFA; } .ShiftOperatorReplacement { background: #9ACD32; } .RemoveMethod { background: #FF00D4; } .RelationalOperatorReplacement { background: #FFA07A; } .ArithmeticOperatorReplacementShortcut { background: #FF00FF; } </style></head><body><h1>LittleDarwin Aggregate Mutation Report</h1><p>Average Density: 0.39</p><div><pre class="code"><span class="outsideLine"><i>0001</i> /*                                                                                                                     
</span><span class="outsideLine"><i>0002</i>  * Licensed to the Apache Software Foundation (ASF) under one or more                                                  
</span><span class="outsideLine"><i>0003</i>  * contributor license agreements.  See the NOTICE file distributed with                                               
</span><span class="outsideLine"><i>0004</i>  * this work for additional information regarding copyright ownership.                                                 
</span><span class="outsideLine"><i>0005</i>  * The ASF licenses this file to You under the Apache License, Version 2.0                                             
</span><span class="outsideLine"><i>0006</i>  * (the "License"); you may not use this file except in compliance with                                                
</span><span class="outsideLine"><i>0007</i>  * the License.  You may obtain a copy of the License at                                                               
</span><span class="outsideLine"><i>0008</i>  *                                                                                                                     
</span><span class="outsideLine"><i>0009</i>  *      http://www.apache.org/licenses/LICENSE-2.0                                                                     
</span><span class="outsideLine"><i>0010</i>  *                                                                                                                     
</span><span class="outsideLine"><i>0011</i>  * Unless required by applicable law or agreed to in writing, software                                                 
</span><span class="outsideLine"><i>0012</i>  * distributed under the License is distributed on an "AS IS" BASIS,                                                   
</span><span class="outsideLine"><i>0013</i>  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                            
</span><span class="outsideLine"><i>0014</i>  * See the License for the specific language governing permissions and                                                 
</span><span class="outsideLine"><i>0015</i>  * limitations under the License.                                                                                      
</span><span class="outsideLine"><i>0016</i>  */                                                                                                                    
</span><span class="outsideLine"><i>0017</i> package org.apache.pdfbox.pdfwriter;                                                                                   
</span><span class="outsideLine"><i>0018</i>                                                                                                                        
</span><span class="outsideLine"><i>0019</i> import java.io.ByteArrayOutputStream;                                                                                  
</span><span class="outsideLine"><i>0020</i> import java.io.Closeable;                                                                                              
</span><span class="outsideLine"><i>0021</i> import java.io.IOException;                                                                                            
</span><span class="outsideLine"><i>0022</i> import java.io.InputStream;                                                                                            
</span><span class="outsideLine"><i>0023</i> import java.io.OutputStream;                                                                                           
</span><span class="outsideLine"><i>0024</i> import java.io.SequenceInputStream;                                                                                    
</span><span class="outsideLine"><i>0025</i> import java.security.MessageDigest;                                                                                    
</span><span class="outsideLine"><i>0026</i> import java.security.NoSuchAlgorithmException;                                                                         
</span><span class="outsideLine"><i>0027</i> import java.text.DecimalFormat;                                                                                        
</span><span class="outsideLine"><i>0028</i> import java.text.DecimalFormatSymbols;                                                                                 
</span><span class="outsideLine"><i>0029</i> import java.text.NumberFormat;                                                                                         
</span><span class="outsideLine"><i>0030</i> import java.util.ArrayList;                                                                                            
</span><span class="outsideLine"><i>0031</i> import java.util.Collections;                                                                                          
</span><span class="outsideLine"><i>0032</i> import java.util.Deque;                                                                                                
</span><span class="outsideLine"><i>0033</i> import java.util.HashMap;                                                                                              
</span><span class="outsideLine"><i>0034</i> import java.util.HashSet;                                                                                              
</span><span class="outsideLine"><i>0035</i> import java.util.Hashtable;                                                                                            
</span><span class="outsideLine"><i>0036</i> import java.util.Iterator;                                                                                             
</span><span class="outsideLine"><i>0037</i> import java.util.LinkedList;                                                                                           
</span><span class="outsideLine"><i>0038</i> import java.util.List;                                                                                                 
</span><span class="outsideLine"><i>0039</i> import java.util.Locale;                                                                                               
</span><span class="outsideLine"><i>0040</i> import java.util.Map;                                                                                                  
</span><span class="outsideLine"><i>0041</i> import java.util.Set;                                                                                                  
</span><span class="outsideLine"><i>0042</i>                                                                                                                        
</span><span class="outsideLine"><i>0043</i> import org.apache.commons.logging.Log;                                                                                 
</span><span class="outsideLine"><i>0044</i> import org.apache.commons.logging.LogFactory;                                                                          
</span><span class="outsideLine"><i>0045</i> import org.apache.pdfbox.cos.COSArray;                                                                                 
</span><span class="outsideLine"><i>0046</i> import org.apache.pdfbox.cos.COSBase;                                                                                  
</span><span class="outsideLine"><i>0047</i> import org.apache.pdfbox.cos.COSBoolean;                                                                               
</span><span class="outsideLine"><i>0048</i> import org.apache.pdfbox.cos.COSDictionary;                                                                            
</span><span class="outsideLine"><i>0049</i> import org.apache.pdfbox.cos.COSDocument;                                                                              
</span><span class="outsideLine"><i>0050</i> import org.apache.pdfbox.cos.COSFloat;                                                                                 
</span><span class="outsideLine"><i>0051</i> import org.apache.pdfbox.cos.COSInteger;                                                                               
</span><span class="outsideLine"><i>0052</i> import org.apache.pdfbox.cos.COSName;                                                                                  
</span><span class="outsideLine"><i>0053</i> import org.apache.pdfbox.cos.COSNull;                                                                                  
</span><span class="outsideLine"><i>0054</i> import org.apache.pdfbox.cos.COSNumber;                                                                                
</span><span class="outsideLine"><i>0055</i> import org.apache.pdfbox.cos.COSObject;                                                                                
</span><span class="outsideLine"><i>0056</i> import org.apache.pdfbox.cos.COSObjectKey;                                                                             
</span><span class="outsideLine"><i>0057</i> import org.apache.pdfbox.cos.COSStream;                                                                                
</span><span class="outsideLine"><i>0058</i> import org.apache.pdfbox.cos.COSString;                                                                                
</span><span class="outsideLine"><i>0059</i> import org.apache.pdfbox.cos.COSUpdateInfo;                                                                            
</span><span class="outsideLine"><i>0060</i> import org.apache.pdfbox.cos.ICOSVisitor;                                                                              
</span><span class="outsideLine"><i>0061</i> import org.apache.pdfbox.io.IOUtils;                                                                                   
</span><span class="outsideLine"><i>0062</i> import org.apache.pdfbox.io.RandomAccessInputStream;                                                                   
</span><span class="outsideLine"><i>0063</i> import org.apache.pdfbox.io.RandomAccessRead;                                                                          
</span><span class="outsideLine"><i>0064</i> import org.apache.pdfbox.pdfparser.PDFXRefStream;                                                                      
</span><span class="outsideLine"><i>0065</i> import org.apache.pdfbox.pdmodel.PDDocument;                                                                           
</span><span class="outsideLine"><i>0066</i> import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;                                                           
</span><span class="outsideLine"><i>0067</i> import org.apache.pdfbox.pdmodel.fdf.FDFDocument;                                                                      
</span><span class="outsideLine"><i>0068</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream;                                    
</span><span class="outsideLine"><i>0069</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureInterface;                                      
</span><span class="outsideLine"><i>0070</i> import org.apache.pdfbox.util.Charsets;                                                                                
</span><span class="outsideLine"><i>0071</i> import org.apache.pdfbox.util.Hex;                                                                                     
</span><span class="outsideLine"><i>0072</i>                                                                                                                        
</span><span class="outsideLine"><i>0073</i> /**                                                                                                                    
</span><span class="outsideLine"><i>0074</i>  * This class acts on a in-memory representation of a PDF document.                                                    
</span><span class="outsideLine"><i>0075</i>  *                                                                                                                     
</span><span class="outsideLine"><i>0076</i>  * @author Michael Traut                                                                                               
</span><span class="outsideLine"><i>0077</i>  * @author Ben Litchfield                                                                                              
</span><span class="outsideLine"><i>0078</i>  */                                                                                                                    
</span><span class="outsideLine"><i>0079</i> public class COSWriter implements ICOSVisitor, Closeable                                                               
</span><span class="outsideLine"><i>0080</i> {                                                                                                                      
</span><span class="outsideLine"><i>0081</i>     private static final Log LOG = LogFactory.getLog(COSWriter.class);                                                 
</span><span class="outsideLine"><i>0082</i>                                                                                                                        
</span><span class="outsideLine"><i>0083</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0084</i>      * The dictionary open token.                                                                                      
</span><span class="outsideLine"><i>0085</i>      */                                                                                                                
</span><span class="outsideLine"><i>0086</i>     public static final byte[] DICT_OPEN = "<<".getBytes(Charsets.US_ASCII);                                           
</span><span class="outsideLine"><i>0087</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0088</i>      * The dictionary close token.                                                                                     
</span><span class="outsideLine"><i>0089</i>      */                                                                                                                
</span><span class="outsideLine"><i>0090</i>     public static final byte[] DICT_CLOSE = ">>".getBytes(Charsets.US_ASCII);                                          
</span><span class="outsideLine"><i>0091</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0092</i>      * space character.                                                                                                
</span><span class="outsideLine"><i>0093</i>      */                                                                                                                
</span><span class="outsideLine"><i>0094</i>     public static final byte[] SPACE = { ' ' };                                                                        
</span><span class="outsideLine"><i>0095</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0096</i>      * The start to a PDF comment.                                                                                     
</span><span class="outsideLine"><i>0097</i>      */                                                                                                                
</span><span class="outsideLine"><i>0098</i>     public static final byte[] COMMENT = { '%' };                                                                      
</span><span class="outsideLine"><i>0099</i>                                                                                                                        
</span><span class="outsideLine"><i>0100</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0101</i>      * The output version of the PDF.                                                                                  
</span><span class="outsideLine"><i>0102</i>      */                                                                                                                
</span><span class="outsideLine"><i>0103</i>     public static final byte[] VERSION = "PDF-1.4".getBytes(Charsets.US_ASCII);                                        
</span><span class="outsideLine"><i>0104</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0105</i>      * Garbage bytes used to create the PDF header.                                                                    
</span><span class="outsideLine"><i>0106</i>      */                                                                                                                
</span><span class="outsideLine"><i>0107</i>     public static final byte[] GARBAGE = new byte[] {(byte)0xf6, (byte)0xe4, (byte)0xfc, (byte)0xdf};                  
</span><span class="outsideLine"><i>0108</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0109</i>      * The EOF constant.                                                                                               
</span><span class="outsideLine"><i>0110</i>      */                                                                                                                
</span><span class="outsideLine"><i>0111</i>     public static final byte[] EOF = "%%EOF".getBytes(Charsets.US_ASCII);                                              
</span><span class="outsideLine"><i>0112</i>     // pdf tokens                                                                                                      
</span><span class="outsideLine"><i>0113</i>                                                                                                                        
</span><span class="outsideLine"><i>0114</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0115</i>      * The reference token.                                                                                            
</span><span class="outsideLine"><i>0116</i>      */                                                                                                                
</span><span class="outsideLine"><i>0117</i>     public static final byte[] REFERENCE = "R".getBytes(Charsets.US_ASCII);                                            
</span><span class="outsideLine"><i>0118</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0119</i>      * The XREF token.                                                                                                 
</span><span class="outsideLine"><i>0120</i>      */                                                                                                                
</span><span class="outsideLine"><i>0121</i>     public static final byte[] XREF = "xref".getBytes(Charsets.US_ASCII);                                              
</span><span class="outsideLine"><i>0122</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0123</i>      * The xref free token.                                                                                            
</span><span class="outsideLine"><i>0124</i>      */                                                                                                                
</span><span class="outsideLine"><i>0125</i>     public static final byte[] XREF_FREE = "f".getBytes(Charsets.US_ASCII);                                            
</span><span class="outsideLine"><i>0126</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0127</i>      * The xref used token.                                                                                            
</span><span class="outsideLine"><i>0128</i>      */                                                                                                                
</span><span class="outsideLine"><i>0129</i>     public static final byte[] XREF_USED = "n".getBytes(Charsets.US_ASCII);                                            
</span><span class="outsideLine"><i>0130</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0131</i>      * The trailer token.                                                                                              
</span><span class="outsideLine"><i>0132</i>      */                                                                                                                
</span><span class="outsideLine"><i>0133</i>     public static final byte[] TRAILER = "trailer".getBytes(Charsets.US_ASCII);                                        
</span><span class="outsideLine"><i>0134</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0135</i>      * The start xref token.                                                                                           
</span><span class="outsideLine"><i>0136</i>      */                                                                                                                
</span><span class="outsideLine"><i>0137</i>     public static final byte[] STARTXREF = "startxref".getBytes(Charsets.US_ASCII);                                    
</span><span class="outsideLine"><i>0138</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0139</i>      * The starting object token.                                                                                      
</span><span class="outsideLine"><i>0140</i>      */                                                                                                                
</span><span class="outsideLine"><i>0141</i>     public static final byte[] OBJ = "obj".getBytes(Charsets.US_ASCII);                                                
</span><span class="outsideLine"><i>0142</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0143</i>      * The end object token.                                                                                           
</span><span class="outsideLine"><i>0144</i>      */                                                                                                                
</span><span class="outsideLine"><i>0145</i>     public static final byte[] ENDOBJ = "endobj".getBytes(Charsets.US_ASCII);                                          
</span><span class="outsideLine"><i>0146</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0147</i>      * The array open token.                                                                                           
</span><span class="outsideLine"><i>0148</i>      */                                                                                                                
</span><span class="outsideLine"><i>0149</i>     public static final byte[] ARRAY_OPEN = "[".getBytes(Charsets.US_ASCII);                                           
</span><span class="outsideLine"><i>0150</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0151</i>      * The array close token.                                                                                          
</span><span class="outsideLine"><i>0152</i>      */                                                                                                                
</span><span class="outsideLine"><i>0153</i>     public static final byte[] ARRAY_CLOSE = "]".getBytes(Charsets.US_ASCII);                                          
</span><span class="outsideLine"><i>0154</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0155</i>      * The open stream token.                                                                                          
</span><span class="outsideLine"><i>0156</i>      */                                                                                                                
</span><span class="outsideLine"><i>0157</i>     public static final byte[] STREAM = "stream".getBytes(Charsets.US_ASCII);                                          
</span><span class="outsideLine"><i>0158</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0159</i>      * The close stream token.                                                                                         
</span><span class="outsideLine"><i>0160</i>      */                                                                                                                
</span><span class="outsideLine"><i>0161</i>     public static final byte[] ENDSTREAM = "endstream".getBytes(Charsets.US_ASCII);                                    
</span><span class="outsideLine"><i>0162</i>                                                                                                                        
</span><span class="outsideLine"><i>0163</i>     private final NumberFormat formatXrefOffset = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3383</span>new DecimalFormat("0000000000",                                      
</span><span class="outsideLine"><i>0164</i>             DecimalFormatSymbols.getInstance(Locale.US))</span>;                                                              
</span><span class="outsideLine"><i>0165</i>                                                                                                                        
</span><span class="outsideLine"><i>0166</i>     // the decimal format for the xref object generation number data                                                   
</span><span class="outsideLine"><i>0167</i>     private final NumberFormat formatXrefGeneration = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3385</span>new DecimalFormat("00000",                                       
</span><span class="outsideLine"><i>0168</i>             DecimalFormatSymbols.getInstance(Locale.US))</span>;                                                              
</span><span class="outsideLine"><i>0169</i>                                                                                                                        
</span><span class="outsideLine"><i>0170</i>     // the stream where we create the pdf output                                                                       
</span><span class="outsideLine"><i>0171</i>     private OutputStream output;                                                                                       
</span><span class="outsideLine"><i>0172</i>                                                                                                                        
</span><span class="outsideLine"><i>0173</i>     // the stream used to write standard cos data                                                                      
</span><span class="outsideLine"><i>0174</i>     private COSStandardOutputStream standardOutput;                                                                    
</span><span class="outsideLine"><i>0175</i>                                                                                                                        
</span><span class="outsideLine"><i>0176</i>     // the start position of the x ref section                                                                         
</span><span class="outsideLine"><i>0177</i>     private long startxref = 0;                                                                                        
</span><span class="outsideLine"><i>0178</i>                                                                                                                        
</span><span class="outsideLine"><i>0179</i>     // the current object number                                                                                       
</span><span class="outsideLine"><i>0180</i>     private long number = 0;                                                                                           
</span><span class="outsideLine"><i>0181</i>                                                                                                                        
</span><span class="outsideLine"><i>0182</i>     // maps the object to the keys generated in the writer                                                             
</span><span class="outsideLine"><i>0183</i>     // these are used for indirect references in other objects                                                         
</span><span class="outsideLine"><i>0184</i>     //A hashtable is used on purpose over a hashmap                                                                    
</span><span class="outsideLine"><i>0185</i>     //so that null entries will not get added.                                                                         
</span><span class="outsideLine"><i>0186</i>     @SuppressWarnings({"squid:S1149"})                                                                                 
</span><span class="outsideLine"><i>0187</i>     private final Map<COSBase,COSObjectKey> objectKeys = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3392</span>new Hashtable<COSBase,COSObjectKey>()</span>;                        
</span><span class="outsideLine"><i>0188</i>                                                                                                                        
</span><span class="outsideLine"><i>0189</i>     private final Map<COSObjectKey,COSBase> keyObject = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3396</span>new HashMap<COSObjectKey,COSBase>()</span>;                           
</span><span class="outsideLine"><i>0190</i>                                                                                                                        
</span><span class="outsideLine"><i>0191</i>     // the list of x ref entries to be made so far                                                                     
</span><span class="outsideLine"><i>0192</i>     private final List<COSWriterXRefEntry> xRefEntries = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3399</span>new ArrayList<COSWriterXRefEntry>()</span>;                          
</span><span class="outsideLine"><i>0193</i>     private final Set<COSBase> objectsToWriteSet = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3402</span>new HashSet<COSBase>()</span>;                                             
</span><span class="outsideLine"><i>0194</i>                                                                                                                        
</span><span class="outsideLine"><i>0195</i>     //A list of objects to write.                                                                                      
</span><span class="outsideLine"><i>0196</i>     private final Deque<COSBase> objectsToWrite = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3405</span>new LinkedList<COSBase>()</span>;                                           
</span><span class="outsideLine"><i>0197</i>                                                                                                                        
</span><span class="outsideLine"><i>0198</i>     //a list of objects already written                                                                                
</span><span class="outsideLine"><i>0199</i>     private final Set<COSBase> writtenObjects = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3408</span>new HashSet<COSBase>()</span>;                                                
</span><span class="outsideLine"><i>0200</i>                                                                                                                        
</span><span class="outsideLine"><i>0201</i>     //An 'actual' is any COSBase that is not a COSObject.                                                              
</span><span class="outsideLine"><i>0202</i>     //need to keep a list of the actuals that are added                                                                
</span><span class="outsideLine"><i>0203</i>     //as well as the objects because there is a problem                                                                
</span><span class="outsideLine"><i>0204</i>     //when adding a COSObject and then later adding                                                                    
</span><span class="outsideLine"><i>0205</i>     //the actual for that object, so we will track                                                                     
</span><span class="outsideLine"><i>0206</i>     //actuals separately.                                                                                              
</span><span class="outsideLine"><i>0207</i>     private final Set<COSBase> actualsAdded = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3411</span>new HashSet<COSBase>()</span>;                                                  
</span><span class="outsideLine"><i>0208</i>                                                                                                                        
</span><span class="outsideLine"><i>0209</i>     private COSObjectKey currentObjectKey = null;                                                                      
</span><span class="outsideLine"><i>0210</i>     private PDDocument pdDocument = null;                                                                              
</span><span class="outsideLine"><i>0211</i>     private FDFDocument fdfDocument = null;                                                                            
</span><span class="outsideLine"><i>0212</i>     private boolean willEncrypt = false;                                                                               
</span><span class="outsideLine"><i>0213</i>                                                                                                                        
</span><span class="outsideLine"><i>0214</i>     // signing                                                                                                         
</span><span class="outsideLine"><i>0215</i>     private boolean incrementalUpdate = false;                                                                         
</span><span class="outsideLine"><i>0216</i>     private boolean reachedSignature = false;                                                                          
</span><span class="outsideLine"><i>0217</i>     private long signatureOffset;                                                                                      
</span><span class="outsideLine"><i>0218</i>     private long signatureLength;                                                                                      
</span><span class="outsideLine"><i>0219</i>     private long byteRangeOffset;                                                                                      
</span><span class="outsideLine"><i>0220</i>     private long byteRangeLength;                                                                                      
</span><span class="outsideLine"><i>0221</i>     private RandomAccessRead incrementalInput;                                                                         
</span><span class="outsideLine"><i>0222</i>     private OutputStream incrementalOutput;                                                                            
</span><span class="outsideLine"><i>0223</i>     private SignatureInterface signatureInterface;                                                                     
</span><span class="outsideLine"><i>0224</i>     private byte[] incrementPart;                                                                                      
</span><span class="outsideLine"><i>0225</i>     private COSArray byteRangeArray;                                                                                   
</span><span class="outsideLine"><i>0226</i>                                                                                                                        
</span><span class="outsideLine"><i>0227</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0228</i>      * COSWriter constructor.                                                                                          
</span><span class="outsideLine"><i>0229</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0230</i>      * @param outputStream The output stream to write the PDF. It will be closed when this object is                   
</span><span class="outsideLine"><i>0231</i>      * closed.                                                                                                         
</span><span class="outsideLine"><i>0232</i>      */                                                                                                                
</span><span class="outsideLine"><i>0233</i>     public COSWriter(OutputStream outputStream)                                                                        
</span><span class="methodLine"><i>0234</i>     {                                                                                                                  
</span><span class="methodLine"><i>0235</i>         setOutput(outputStream);                                                                                       
</span><span class="methodLine"><i>0236</i>         setStandardOutput(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6566</span>new COSStandardOutputStream(output)</span>);                                                        
</span><span class="methodLine"><i>0237</i>     }                                                                                                                  
</span><span class="outsideLine"><i>0238</i>                                                                                                                        
</span><span class="outsideLine"><i>0239</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0240</i>      * COSWriter constructor for incremental updates. There must be a path of objects that have                        
</span><span class="outsideLine"><i>0241</i>      * {@link COSUpdateInfo#isNeedToBeUpdated()} set, starting from the document catalog. For                          
</span><span class="outsideLine"><i>0242</i>      * signatures this is taken care by PDFBox itself.                                                                 
</span><span class="outsideLine"><i>0243</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0244</i>      * @param outputStream output stream where the new PDF data will be written. It will be closed                     
</span><span class="outsideLine"><i>0245</i>      * when this object is closed.                                                                                     
</span><span class="outsideLine"><i>0246</i>      * @param inputData random access read containing source PDF data                                                  
</span><span class="outsideLine"><i>0247</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0248</i>      * @throws IOException if something went wrong                                                                     
</span><span class="outsideLine"><i>0249</i>      */                                                                                                                
</span><span class="outsideLine"><i>0250</i>     public COSWriter(OutputStream outputStream, RandomAccessRead inputData) throws IOException                         
</span><span class="methodLine"><i>0251</i>     {                                                                                                                  
</span><span class="outsideLine"><i>0252</i>         // write to buffer instead of output                                                                           
</span><span class="methodLine"><i>0253</i>         setOutput(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6569</span>new ByteArrayOutputStream()</span>);                                                                        
</span><span class="methodLine"><i>0254</i>         setStandardOutput(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6572</span>new COSStandardOutputStream(output, inputData.length())</span>);                                    
</span><span class="outsideLine"><i>0255</i>                                                                                                                        
</span><span class="methodLine"><i>0256</i>         incrementalInput = inputData;                                                                                  
</span><span class="methodLine"><i>0257</i>         incrementalOutput = outputStream;                                                                              
</span><span class="methodLine"><i>0258</i>         incrementalUpdate = true;                                                                                      
</span><span class="methodLine"><i>0259</i>     }                                                                                                                  
</span><span class="outsideLine"><i>0260</i>                                                                                                                        
</span><span class="outsideLine"><i>0261</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0262</i>      * Constructor for incremental updates with a list of objects to write. This allows to                             
</span><span class="outsideLine"><i>0263</i>      * include objects even if there is no path of objects that have                                                   
</span><span class="outsideLine"><i>0264</i>      * {@link COSUpdateInfo#isNeedToBeUpdated()} set so the incremental update gets smaller. Only                      
</span><span class="outsideLine"><i>0265</i>      * dictionaries are supported; if you need to update other objects classes, then add their                         
</span><span class="outsideLine"><i>0266</i>      * parent dictionary.                                                                                              
</span><span class="outsideLine"><i>0267</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0268</i>      * @param outputStream output stream where the new PDF data will be written. It will be closed                     
</span><span class="outsideLine"><i>0269</i>      * when this object is closed.                                                                                     
</span><span class="outsideLine"><i>0270</i>      * @param inputData random access read containing source PDF data.                                                 
</span><span class="outsideLine"><i>0271</i>      * @param objectsToWrite objects that <b>must</b> be part of the incremental saving.                               
</span><span class="outsideLine"><i>0272</i>      * @throws IOException if something went wrong                                                                     
</span><span class="outsideLine"><i>0273</i>      */                                                                                                                
</span><span class="outsideLine"><i>0274</i>     public COSWriter(OutputStream outputStream, RandomAccessRead inputData,                                            
</span><span class="outsideLine"><i>0275</i>             Set<COSDictionary> objectsToWrite) throws IOException                                                      
</span><span class="methodLine"><i>0276</i>     {                                                                                                                  
</span><span class="outsideLine"><i>0277</i>         // Implementation notes / summary of April 2019 comments in PDFBOX-45:                                         
</span><span class="outsideLine"><i>0278</i>         // we allow only COSDictionary in objectsToWrite because other types,                                          
</span><span class="outsideLine"><i>0279</i>         // especially COSArray, are written directly. If we'd allow them with the current                              
</span><span class="outsideLine"><i>0280</i>         // COSWriter implementation, they would be written twice,                                                      
</span><span class="outsideLine"><i>0281</i>         // once directly and once indirectly as orphan.                                                                
</span><span class="outsideLine"><i>0282</i>         // One could improve visitFromArray and visitFromDictionary (see commit 1856891)                               
</span><span class="outsideLine"><i>0283</i>         // to handle arrays like dictionaries so that arrays are written indirectly,                                   
</span><span class="outsideLine"><i>0284</i>         // but this produces very inefficient files.                                                                   
</span><span class="outsideLine"><i>0285</i>         // If there is ever a real need to update arrays, then a future implementation could                           
</span><span class="outsideLine"><i>0286</i>         // recommit change 1856891 (also needs to move the byteRange position detection code)                          
</span><span class="outsideLine"><i>0287</i>         // and also set isDirect in arrays to true by default, to avoid inefficient files.                             
</span><span class="outsideLine"><i>0288</i>         // COSArray.setDirect(true) is called at some places in the current implementation for                         
</span><span class="outsideLine"><i>0289</i>         // documentational purposes only.                                                                              
</span><span class="methodLine"><i>0290</i>         this(outputStream, inputData);                                                                                 
</span><span class="methodLine"><i>0291</i>         this.objectsToWrite.addAll(objectsToWrite);                                                                    
</span><span class="methodLine"><i>0292</i>     }                                                                                                                  
</span><span class="outsideLine"><i>0293</i>                                                                                                                        
</span><span class="outsideLine"><i>0294</i>     private void prepareIncrement(PDDocument doc)                                                                      
</span><span class="methodLine"><i>0295</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1513</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0296</i>       try                                                                                                              
</span><span class="methodLine"><i>0297</i>       {                                                                                                                
</span><span class="methodLine"><i>0298</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 6588</span>doc <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 6588</span>!=</span> null</span>)                                                                                               
</span><span class="methodLine"><i>0299</i>         {                                                                                                              
</span><span class="methodLine"><i>0300</i>           COSDocument cosDoc = doc.getDocument();                                                                      
</span><span class="outsideLine"><i>0301</i>                                                                                                                        
</span><span class="methodLine"><i>0302</i>           Map<COSObjectKey, Long> xrefTable = cosDoc.getXrefTable();                                                   
</span><span class="methodLine"><i>0303</i>           Set<COSObjectKey> keySet = xrefTable.keySet();                                                               
</span><span class="methodLine"><i>0304</i>           long highestNumber = doc.getDocument().getHighestXRefObjectNumber();                                         
</span><span class="methodLine"><i>0305</i>           for ( COSObjectKey cosObjectKey : keySet )                                                                   
</span><span class="methodLine"><i>0306</i>           {                                                                                                            
</span><span class="methodLine"><i>0307</i>             COSBase object = cosDoc.getObjectFromPool(cosObjectKey).getObject();                                       
</span><span class="methodLine"><i>0308</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 12126</span>object <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12126</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 11900</span>&&</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 12128</span>cosObjectKey<span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12128</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 11605</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 11902</span>!</span>(object instanceof COSNumber))                               
</span><span class="methodLine"><i>0309</i>             {                                                                                                          
</span><span class="methodLine"><i>0310</i>                 objectKeys.put(object, cosObjectKey);                                                                  
</span><span class="methodLine"><i>0311</i>                 keyObject.put(cosObjectKey,object);                                                                    
</span><span class="methodLine"><i>0312</i>             }                                                                                                          
</span><span class="outsideLine"><i>0313</i>                                                                                                                        
</span><span class="methodLine"><i>0314</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 11609</span>cosObjectKey <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 11609</span>!=</span> null</span>)                                                                                  
</span><span class="methodLine"><i>0315</i>             {                                                                                                          
</span><span class="methodLine"><i>0316</i>                 long num = cosObjectKey.getNumber();                                                                   
</span><span class="methodLine"><i>0317</i>                 if (num <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12490</span>></span> highestNumber)                                                                               
</span><span class="methodLine"><i>0318</i>                 {                                                                                                      
</span><span class="methodLine"><i>0319</i>                     highestNumber = num;                                                                               
</span><span class="methodLine"><i>0320</i>                 }                                                                                                      
</span><span class="methodLine"><i>0321</i>             }                                                                                                          
</span><span class="methodLine"><i>0322</i>           }                                                                                                            
</span><span class="methodLine"><i>0323</i>           setNumber(highestNumber);                                                                                    
</span><span class="methodLine"><i>0324</i>         }                                                                                                              
</span><span class="methodLine"><i>0325</i>       }                                                                                                                
</span><span class="methodLine"><i>0326</i>       catch (IOException e)                                                                                            
</span><span class="methodLine"><i>0327</i>       {                                                                                                                
</span><span class="methodLine"><i>0328</i>           LOG.error(e,e);                                                                                              
</span><span class="methodLine"><i>0329</i>       }                                                                                                                
</span><span class="methodLine"><i>0330</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0331</i>                                                                                                                        
</span><span class="outsideLine"><i>0332</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0333</i>      * add an entry in the x ref table for later dump.                                                                 
</span><span class="outsideLine"><i>0334</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0335</i>      * @param entry The new entry to add.                                                                              
</span><span class="outsideLine"><i>0336</i>      */                                                                                                                
</span><span class="outsideLine"><i>0337</i>     protected void addXRefEntry(COSWriterXRefEntry entry)                                                              
</span><span class="methodLine"><i>0338</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1518</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0339</i>         getXRefEntries().add(entry);                                                                                   
</span><span class="methodLine"><i>0340</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0341</i>                                                                                                                        
</span><span class="outsideLine"><i>0342</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0343</i>      * This will close the stream.                                                                                     
</span><span class="outsideLine"><i>0344</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0345</i>      * @throws IOException If the underlying stream throws an exception.                                               
</span><span class="outsideLine"><i>0346</i>      */                                                                                                                
</span><span class="outsideLine"><i>0347</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>0348</i>     public void close() throws IOException                                                                             
</span><span class="methodLine"><i>0349</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1526</span>{                                                                                                                  
</span><span class="methodLine"><i>0350</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4170</span>getStandardOutput() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4170</span>!=</span> null</span>)                                                                               
</span><span class="methodLine"><i>0351</i>         {                                                                                                              
</span><span class="methodLine"><i>0352</i>             getStandardOutput().close();                                                                               
</span><span class="methodLine"><i>0353</i>         }                                                                                                              
</span><span class="methodLine"><i>0354</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4174</span>incrementalOutput <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4174</span>!=</span> null</span>)                                                                                 
</span><span class="methodLine"><i>0355</i>         {                                                                                                              
</span><span class="methodLine"><i>0356</i>             incrementalOutput.close();                                                                                 
</span><span class="methodLine"><i>0357</i>         }                                                                                                              
</span><span class="methodLine"><i>0358</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0359</i>                                                                                                                        
</span><span class="outsideLine"><i>0360</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0361</i>      * This will get the current object number.                                                                        
</span><span class="outsideLine"><i>0362</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0363</i>      * @return The current object number.                                                                              
</span><span class="outsideLine"><i>0364</i>      */                                                                                                                
</span><span class="outsideLine"><i>0365</i>     protected long getNumber()                                                                                         
</span><span class="methodLine"><i>0366</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return 1L;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1531</span>{                                                                                                                  
</span><span class="methodLine"><i>0367</i>         return number;                                                                                                 
</span><span class="methodLine"><i>0368</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0369</i>                                                                                                                        
</span><span class="outsideLine"><i>0370</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0371</i>      * This will get all available object keys.                                                                        
</span><span class="outsideLine"><i>0372</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0373</i>      * @return A map of all object keys.                                                                               
</span><span class="outsideLine"><i>0374</i>      */                                                                                                                
</span><span class="outsideLine"><i>0375</i>     public Map<COSBase,COSObjectKey> getObjectKeys()                                                                   
</span><span class="methodLine"><i>0376</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1536</span>{                                                                                                                  
</span><span class="methodLine"><i>0377</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3012</span>return objectKeys;</span>                                                                                             
</span><span class="methodLine"><i>0378</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0379</i>                                                                                                                        
</span><span class="outsideLine"><i>0380</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0381</i>      * This will get the output stream.                                                                                
</span><span class="outsideLine"><i>0382</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0383</i>      * @return The output stream.                                                                                      
</span><span class="outsideLine"><i>0384</i>      */                                                                                                                
</span><span class="outsideLine"><i>0385</i>     protected java.io.OutputStream getOutput()                                                                         
</span><span class="methodLine"><i>0386</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1541</span>{                                                                                                                  
</span><span class="methodLine"><i>0387</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3013</span>return output;</span>                                                                                                 
</span><span class="methodLine"><i>0388</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0389</i>                                                                                                                        
</span><span class="outsideLine"><i>0390</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0391</i>      * This will get the standard output stream.                                                                       
</span><span class="outsideLine"><i>0392</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0393</i>      * @return The standard output stream.                                                                             
</span><span class="outsideLine"><i>0394</i>      */                                                                                                                
</span><span class="outsideLine"><i>0395</i>     protected COSStandardOutputStream getStandardOutput()                                                              
</span><span class="methodLine"><i>0396</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1546</span>{                                                                                                                  
</span><span class="methodLine"><i>0397</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3014</span>return standardOutput;</span>                                                                                         
</span><span class="methodLine"><i>0398</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0399</i>                                                                                                                        
</span><span class="outsideLine"><i>0400</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0401</i>      * This will get the current start xref.                                                                           
</span><span class="outsideLine"><i>0402</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0403</i>      * @return The current start xref.                                                                                 
</span><span class="outsideLine"><i>0404</i>      */                                                                                                                
</span><span class="outsideLine"><i>0405</i>     protected long getStartxref()                                                                                      
</span><span class="methodLine"><i>0406</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return 1L;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1551</span>{                                                                                                                  
</span><span class="methodLine"><i>0407</i>         return startxref;                                                                                              
</span><span class="methodLine"><i>0408</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0409</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0410</i>      * This will get the xref entries.                                                                                 
</span><span class="outsideLine"><i>0411</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0412</i>      * @return All available xref entries.                                                                             
</span><span class="outsideLine"><i>0413</i>      */                                                                                                                
</span><span class="outsideLine"><i>0414</i>     protected List<COSWriterXRefEntry> getXRefEntries()                                                                
</span><span class="methodLine"><i>0415</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1556</span>{                                                                                                                  
</span><span class="methodLine"><i>0416</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3019</span>return xRefEntries;</span>                                                                                            
</span><span class="methodLine"><i>0417</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0418</i>                                                                                                                        
</span><span class="outsideLine"><i>0419</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0420</i>      * This will set the current object number.                                                                        
</span><span class="outsideLine"><i>0421</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0422</i>      * @param newNumber The new object number.                                                                         
</span><span class="outsideLine"><i>0423</i>      */                                                                                                                
</span><span class="outsideLine"><i>0424</i>     protected void setNumber(long newNumber)                                                                           
</span><span class="methodLine"><i>0425</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1561</span>{                                                                                                                  
</span><span class="methodLine"><i>0426</i>         number = newNumber;                                                                                            
</span><span class="methodLine"><i>0427</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0428</i>                                                                                                                        
</span><span class="outsideLine"><i>0429</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0430</i>      * This will set the output stream.                                                                                
</span><span class="outsideLine"><i>0431</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0432</i>      * @param newOutput The new output stream.                                                                         
</span><span class="outsideLine"><i>0433</i>      */                                                                                                                
</span><span class="outsideLine"><i>0434</i>     private void setOutput( OutputStream newOutput )                                                                   
</span><span class="methodLine"><i>0435</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1566</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0436</i>         output = newOutput;                                                                                            
</span><span class="methodLine"><i>0437</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0438</i>                                                                                                                        
</span><span class="outsideLine"><i>0439</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0440</i>      * This will set the standard output stream.                                                                       
</span><span class="outsideLine"><i>0441</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0442</i>      * @param newStandardOutput The new standard output stream.                                                        
</span><span class="outsideLine"><i>0443</i>      */                                                                                                                
</span><span class="outsideLine"><i>0444</i>     private void setStandardOutput(COSStandardOutputStream newStandardOutput)                                          
</span><span class="methodLine"><i>0445</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1571</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0446</i>         standardOutput = newStandardOutput;                                                                            
</span><span class="methodLine"><i>0447</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0448</i>                                                                                                                        
</span><span class="outsideLine"><i>0449</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0450</i>      * This will set the start xref.                                                                                   
</span><span class="outsideLine"><i>0451</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0452</i>      * @param newStartxref The new start xref attribute.                                                               
</span><span class="outsideLine"><i>0453</i>      */                                                                                                                
</span><span class="outsideLine"><i>0454</i>     protected void setStartxref(long newStartxref)                                                                     
</span><span class="methodLine"><i>0455</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1576</span>{                                                                                                                  
</span><span class="methodLine"><i>0456</i>         startxref = newStartxref;                                                                                      
</span><span class="methodLine"><i>0457</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0458</i>                                                                                                                        
</span><span class="outsideLine"><i>0459</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0460</i>      * This will write the body of the document.                                                                       
</span><span class="outsideLine"><i>0461</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0462</i>      * @param doc The document to write the body for.                                                                  
</span><span class="outsideLine"><i>0463</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0464</i>      * @throws IOException If there is an error writing the data.                                                      
</span><span class="outsideLine"><i>0465</i>      */                                                                                                                
</span><span class="outsideLine"><i>0466</i>     protected void doWriteBody(COSDocument doc) throws IOException                                                     
</span><span class="methodLine"><i>0467</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1583</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0468</i>         COSDictionary trailer = doc.getTrailer();                                                                      
</span><span class="methodLine"><i>0469</i>         COSDictionary root = trailer.getCOSDictionary(COSName.ROOT);                                                   
</span><span class="methodLine"><i>0470</i>         COSDictionary info = trailer.getCOSDictionary(COSName.INFO);                                                   
</span><span class="methodLine"><i>0471</i>         COSDictionary encrypt = trailer.getCOSDictionary(COSName.ENCRYPT);                                             
</span><span class="methodLine"><i>0472</i>         if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4204</span>root <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4204</span>!=</span> null</span> )                                                                                             
</span><span class="methodLine"><i>0473</i>         {                                                                                                              
</span><span class="methodLine"><i>0474</i>             addObjectToWrite( root );                                                                                  
</span><span class="methodLine"><i>0475</i>         }                                                                                                              
</span><span class="methodLine"><i>0476</i>         if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4208</span>info <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4208</span>!=</span> null</span> )                                                                                             
</span><span class="methodLine"><i>0477</i>         {                                                                                                              
</span><span class="methodLine"><i>0478</i>             addObjectToWrite( info );                                                                                  
</span><span class="methodLine"><i>0479</i>         }                                                                                                              
</span><span class="outsideLine"><i>0480</i>                                                                                                                        
</span><span class="methodLine"><i>0481</i>         doWriteObjects();                                                                                              
</span><span class="methodLine"><i>0482</i>         willEncrypt = false;                                                                                           
</span><span class="methodLine"><i>0483</i>         if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4214</span>encrypt <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4214</span>!=</span> null</span> )                                                                                          
</span><span class="methodLine"><i>0484</i>         {                                                                                                              
</span><span class="methodLine"><i>0485</i>             addObjectToWrite( encrypt );                                                                               
</span><span class="methodLine"><i>0486</i>         }                                                                                                              
</span><span class="outsideLine"><i>0487</i>                                                                                                                        
</span><span class="methodLine"><i>0488</i>         doWriteObjects();                                                                                              
</span><span class="methodLine"><i>0489</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0490</i>                                                                                                                        
</span><span class="outsideLine"><i>0491</i>     private void doWriteObjects() throws IOException                                                                   
</span><span class="methodLine"><i>0492</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1590</span>{                                                                                                                  
</span><span class="methodLine"><i>0493</i>         while( objectsToWrite.size() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4219</span>></span> 0 )                                                                             
</span><span class="methodLine"><i>0494</i>         {                                                                                                              
</span><span class="methodLine"><i>0495</i>             COSBase nextObject = objectsToWrite.removeFirst();                                                         
</span><span class="methodLine"><i>0496</i>             objectsToWriteSet.remove(nextObject);                                                                      
</span><span class="methodLine"><i>0497</i>             doWriteObject( nextObject );                                                                               
</span><span class="methodLine"><i>0498</i>         }                                                                                                              
</span><span class="methodLine"><i>0499</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0500</i>                                                                                                                        
</span><span class="outsideLine"><i>0501</i>     private void addObjectToWrite( COSBase object )                                                                    
</span><span class="methodLine"><i>0502</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1595</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0503</i>         COSBase actual = object;                                                                                       
</span><span class="methodLine"><i>0504</i>         if( actual instanceof COSObject )                                                                              
</span><span class="methodLine"><i>0505</i>         {                                                                                                              
</span><span class="methodLine"><i>0506</i>             actual = ((COSObject)actual).getObject();                                                                  
</span><span class="methodLine"><i>0507</i>         }                                                                                                              
</span><span class="outsideLine"><i>0508</i>                                                                                                                        
</span><span class="methodLine"><i>0509</i>         if( <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 5751</span>!</span>writtenObjects.contains( object ) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4855</span>&&</span>                                                                      
</span><span class="methodLine"><i>0510</i>             <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 5753</span>!</span>objectsToWriteSet.contains( object ) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4230</span>&&</span>                                                                   
</span><span class="methodLine"><i>0511</i>             <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4857</span>!</span>actualsAdded.contains( actual ) )                                                                         
</span><span class="methodLine"><i>0512</i>         {                                                                                                              
</span><span class="methodLine"><i>0513</i>             COSBase cosBase=null;                                                                                      
</span><span class="methodLine"><i>0514</i>             COSObjectKey cosObjectKey = null;                                                                          
</span><span class="methodLine"><i>0515</i>             if(<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7557</span>actual <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7557</span>!=</span> null</span>)                                                                                         
</span><span class="methodLine"><i>0516</i>             {                                                                                                          
</span><span class="methodLine"><i>0517</i>                 cosObjectKey= objectKeys.get(actual);                                                                  
</span><span class="methodLine"><i>0518</i>             }                                                                                                          
</span><span class="methodLine"><i>0519</i>             if(<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7561</span>cosObjectKey<span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7561</span>!=</span>null</span>)                                                                                     
</span><span class="methodLine"><i>0520</i>             {                                                                                                          
</span><span class="methodLine"><i>0521</i>                 cosBase = keyObject.get(cosObjectKey);                                                                 
</span><span class="methodLine"><i>0522</i>             }                                                                                                          
</span><span class="methodLine"><i>0523</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 9812</span>actual <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 9812</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 9140</span>&&</span> objectKeys.containsKey(actual)                                                       
</span><span class="methodLine"><i>0524</i>                     <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 8309</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 9142</span>!</span>isNeedToBeUpdated(object) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 7565</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 8311</span>!</span>isNeedToBeUpdated(cosBase))                                      
</span><span class="methodLine"><i>0525</i>             {                                                                                                          
</span><span class="methodLine"><i>0526</i>                 return;                                                                                                
</span><span class="methodLine"><i>0527</i>             }                                                                                                          
</span><span class="methodLine"><i>0528</i>             objectsToWrite.add( object );                                                                              
</span><span class="methodLine"><i>0529</i>             objectsToWriteSet.add( object );                                                                           
</span><span class="methodLine"><i>0530</i>             if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7571</span>actual <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7571</span>!=</span> null</span> )                                                                                       
</span><span class="methodLine"><i>0531</i>             {                                                                                                          
</span><span class="methodLine"><i>0532</i>                 actualsAdded.add( actual );                                                                            
</span><span class="methodLine"><i>0533</i>             }                                                                                                          
</span><span class="methodLine"><i>0534</i>         }                                                                                                              
</span><span class="methodLine"><i>0535</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0536</i>                                                                                                                        
</span><span class="outsideLine"><i>0537</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0538</i>      * Convenience method, so that we get false for types that can't be updated.                                       
</span><span class="outsideLine"><i>0539</i>      * @param base                                                                                                     
</span><span class="outsideLine"><i>0540</i>      * @return                                                                                                         
</span><span class="outsideLine"><i>0541</i>      */                                                                                                                
</span><span class="outsideLine"><i>0542</i>     private boolean isNeedToBeUpdated(COSBase base)                                                                    
</span><span class="methodLine"><i>0543</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return false;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1600</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0544</i>         if (base instanceof COSUpdateInfo)                                                                             
</span><span class="methodLine"><i>0545</i>         {                                                                                                              
</span><span class="methodLine"><i>0546</i>             return ((COSUpdateInfo) base).isNeedToBeUpdated();                                                         
</span><span class="methodLine"><i>0547</i>         }                                                                                                              
</span><span class="methodLine"><i>0548</i>         return false;                                                                                                  
</span><span class="methodLine"><i>0549</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0550</i>                                                                                                                        
</span><span class="outsideLine"><i>0551</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0552</i>      * This will write a COS object.                                                                                   
</span><span class="outsideLine"><i>0553</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0554</i>      * @param obj The object to write.                                                                                 
</span><span class="outsideLine"><i>0555</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0556</i>      * @throws IOException if the output cannot be written                                                             
</span><span class="outsideLine"><i>0557</i>      */                                                                                                                
</span><span class="outsideLine"><i>0558</i>     public void doWriteObject( COSBase obj ) throws IOException                                                        
</span><span class="methodLine"><i>0559</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1607</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0560</i>         writtenObjects.add( obj );                                                                                     
</span><span class="outsideLine"><i>0561</i>         // find the physical reference                                                                                 
</span><span class="methodLine"><i>0562</i>         currentObjectKey = getObjectKey( obj );                                                                        
</span><span class="outsideLine"><i>0563</i>         // add a x ref entry                                                                                           
</span><span class="methodLine"><i>0564</i>         addXRefEntry( <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6693</span>new COSWriterXRefEntry(getStandardOutput().getPos(), obj, currentObjectKey)</span>);                    
</span><span class="outsideLine"><i>0565</i>         // write the object                                                                                            
</span><span class="methodLine"><i>0566</i>         getStandardOutput().write(String.valueOf(currentObjectKey.getNumber()).getBytes(Charsets.ISO_8859_1));         
</span><span class="methodLine"><i>0567</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>0568</i>         getStandardOutput().write(String.valueOf(currentObjectKey.getGeneration()).getBytes(Charsets.ISO_8859_1));     
</span><span class="methodLine"><i>0569</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>0570</i>         getStandardOutput().write(OBJ);                                                                                
</span><span class="methodLine"><i>0571</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0572</i>         obj.accept( this );                                                                                            
</span><span class="methodLine"><i>0573</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0574</i>         getStandardOutput().write(ENDOBJ);                                                                             
</span><span class="methodLine"><i>0575</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0576</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0577</i>                                                                                                                        
</span><span class="outsideLine"><i>0578</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0579</i>      * This will write the header to the PDF document.                                                                 
</span><span class="outsideLine"><i>0580</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0581</i>      * @param doc The document to get the data from.                                                                   
</span><span class="outsideLine"><i>0582</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0583</i>      * @throws IOException If there is an error writing to the stream.                                                 
</span><span class="outsideLine"><i>0584</i>      */                                                                                                                
</span><span class="outsideLine"><i>0585</i>     protected void doWriteHeader(COSDocument doc) throws IOException                                                   
</span><span class="methodLine"><i>0586</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1614</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0587</i>         String headerString;                                                                                           
</span><span class="methodLine"><i>0588</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4257</span>fdfDocument <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4257</span>!=</span> null</span>)                                                                                       
</span><span class="methodLine"><i>0589</i>         {                                                                                                              
</span><span class="methodLine"><i>0590</i>             headerString = "%FDF-"+ doc.getVersion();                                                                  
</span><span class="methodLine"><i>0591</i>         }                                                                                                              
</span><span class="methodLine"><i>0592</i>         else                                                                                                           
</span><span class="methodLine"><i>0593</i>         {                                                                                                              
</span><span class="methodLine"><i>0594</i>             headerString = "%PDF-"+ doc.getVersion();                                                                  
</span><span class="methodLine"><i>0595</i>         }                                                                                                              
</span><span class="methodLine"><i>0596</i>         getStandardOutput().write( headerString.getBytes(Charsets.ISO_8859_1) );                                       
</span><span class="outsideLine"><i>0597</i>                                                                                                                        
</span><span class="methodLine"><i>0598</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0599</i>         getStandardOutput().write(COMMENT);                                                                            
</span><span class="methodLine"><i>0600</i>         getStandardOutput().write(GARBAGE);                                                                            
</span><span class="methodLine"><i>0601</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0602</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0603</i>                                                                                                                        
</span><span class="outsideLine"><i>0604</i>                                                                                                                        
</span><span class="outsideLine"><i>0605</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0606</i>      * This will write the trailer to the PDF document.                                                                
</span><span class="outsideLine"><i>0607</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0608</i>      * @param doc The document to create the trailer for.                                                              
</span><span class="outsideLine"><i>0609</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0610</i>      * @throws IOException If there is an IOError while writing the document.                                          
</span><span class="outsideLine"><i>0611</i>      */                                                                                                                
</span><span class="outsideLine"><i>0612</i>     protected void doWriteTrailer(COSDocument doc) throws IOException                                                  
</span><span class="methodLine"><i>0613</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1621</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0614</i>         getStandardOutput().write(TRAILER);                                                                            
</span><span class="methodLine"><i>0615</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="outsideLine"><i>0616</i>                                                                                                                        
</span><span class="methodLine"><i>0617</i>         COSDictionary trailer = doc.getTrailer();                                                                      
</span><span class="outsideLine"><i>0618</i>         //sort xref, needed only if object keys not regenerated                                                        
</span><span class="methodLine"><i>0619</i>         Collections.sort(getXRefEntries());                                                                            
</span><span class="methodLine"><i>0620</i>         COSWriterXRefEntry lastEntry = getXRefEntries().get( getXRefEntries().size()<span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 8382</span>-</span>1);                               
</span><span class="methodLine"><i>0621</i>         trailer.setLong(COSName.SIZE, lastEntry.getKey().getNumber()<span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 5864</span>+</span>1);                                               
</span><span class="outsideLine"><i>0622</i>         // Only need to stay, if an incremental update will be performed                                               
</span><span class="methodLine"><i>0623</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4276</span>!</span>incrementalUpdate)                                                                                        
</span><span class="methodLine"><i>0624</i>         {                                                                                                              
</span><span class="methodLine"><i>0625</i>           trailer.removeItem( COSName.PREV );                                                                          
</span><span class="methodLine"><i>0626</i>         }                                                                                                              
</span><span class="methodLine"><i>0627</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4280</span>!</span>doc.isXRefStream())                                                                                       
</span><span class="methodLine"><i>0628</i>         {                                                                                                              
</span><span class="methodLine"><i>0629</i>             trailer.removeItem( COSName.XREF_STM );                                                                    
</span><span class="methodLine"><i>0630</i>         }                                                                                                              
</span><span class="outsideLine"><i>0631</i>         // Remove a checksum if present                                                                                
</span><span class="methodLine"><i>0632</i>         trailer.removeItem( COSName.DOC_CHECKSUM );                                                                    
</span><span class="outsideLine"><i>0633</i>                                                                                                                        
</span><span class="methodLine"><i>0634</i>         COSArray idArray = trailer.getCOSArray(COSName.ID);                                                            
</span><span class="methodLine"><i>0635</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4287</span>idArray <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4287</span>!=</span> null</span>)                                                                                           
</span><span class="methodLine"><i>0636</i>         {                                                                                                              
</span><span class="methodLine"><i>0637</i>             idArray.setDirect(true);                                                                                   
</span><span class="methodLine"><i>0638</i>         }                                                                                                              
</span><span class="outsideLine"><i>0639</i>                                                                                                                        
</span><span class="methodLine"><i>0640</i>         trailer.accept(this);                                                                                          
</span><span class="methodLine"><i>0641</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0642</i>                                                                                                                        
</span><span class="outsideLine"><i>0643</i>     private void doWriteXRefInc(COSDocument doc, long hybridPrev) throws IOException                                   
</span><span class="methodLine"><i>0644</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1628</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0645</i>         if (doc.isXRefStream() <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4294</span>||</span> hybridPrev <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4999</span>!=</span> <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 5891</span>-</span>1)                                                                    
</span><span class="methodLine"><i>0646</i>         {                                                                                                              
</span><span class="outsideLine"><i>0647</i>             // the file uses XrefStreams, so we need to update                                                         
</span><span class="outsideLine"><i>0648</i>             // it with an xref stream. We create a new one and fill it                                                 
</span><span class="outsideLine"><i>0649</i>             // with data available here                                                                                
</span><span class="outsideLine"><i>0650</i>                                                                                                                        
</span><span class="outsideLine"><i>0651</i>             // create a new XRefStrema object                                                                          
</span><span class="methodLine"><i>0652</i>             PDFXRefStream pdfxRefStream = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10447</span>new PDFXRefStream(doc)</span>;                                                      
</span><span class="outsideLine"><i>0653</i>                                                                                                                        
</span><span class="outsideLine"><i>0654</i>             // add all entries from the incremental update.                                                            
</span><span class="methodLine"><i>0655</i>             List<COSWriterXRefEntry> xRefEntries2 = getXRefEntries();                                                  
</span><span class="methodLine"><i>0656</i>             for ( COSWriterXRefEntry cosWriterXRefEntry : xRefEntries2 )                                               
</span><span class="methodLine"><i>0657</i>             {                                                                                                          
</span><span class="methodLine"><i>0658</i>                 pdfxRefStream.addEntry(cosWriterXRefEntry);                                                            
</span><span class="methodLine"><i>0659</i>             }                                                                                                          
</span><span class="outsideLine"><i>0660</i>                                                                                                                        
</span><span class="methodLine"><i>0661</i>             COSDictionary trailer = doc.getTrailer();                                                                  
</span><span class="methodLine"><i>0662</i>             if (incrementalUpdate)                                                                                     
</span><span class="methodLine"><i>0663</i>             {                                                                                                          
</span><span class="outsideLine"><i>0664</i>                 // use previous startXref value as new PREV value                                                      
</span><span class="methodLine"><i>0665</i>                 trailer.setLong(COSName.PREV, doc.getStartXref());                                                     
</span><span class="methodLine"><i>0666</i>             }                                                                                                          
</span><span class="methodLine"><i>0667</i>             else                                                                                                       
</span><span class="methodLine"><i>0668</i>             {                                                                                                          
</span><span class="methodLine"><i>0669</i>                 trailer.removeItem(COSName.PREV);                                                                      
</span><span class="methodLine"><i>0670</i>             }                                                                                                          
</span><span class="methodLine"><i>0671</i>             pdfxRefStream.addTrailerInfo(trailer);                                                                     
</span><span class="outsideLine"><i>0672</i>             // the size is the highest object number+1. we add one more                                                
</span><span class="outsideLine"><i>0673</i>             // for the xref stream object we are going to write                                                        
</span><span class="methodLine"><i>0674</i>             pdfxRefStream.setSize(getNumber() <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9236</span>+</span> 2);                                                                    
</span><span class="outsideLine"><i>0675</i>                                                                                                                        
</span><span class="methodLine"><i>0676</i>             setStartxref(getStandardOutput().getPos());                                                                
</span><span class="methodLine"><i>0677</i>             COSStream stream2 = pdfxRefStream.getStream();                                                             
</span><span class="methodLine"><i>0678</i>             doWriteObject(stream2);                                                                                    
</span><span class="methodLine"><i>0679</i>         }                                                                                                              
</span><span class="outsideLine"><i>0680</i>                                                                                                                        
</span><span class="methodLine"><i>0681</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 5012</span>!</span>doc.isXRefStream() <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4298</span>||</span> hybridPrev <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5014</span>!=</span> <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 5906</span>-</span>1)                                                                   
</span><span class="methodLine"><i>0682</i>         {                                                                                                              
</span><span class="methodLine"><i>0683</i>             COSDictionary trailer = doc.getTrailer();                                                                  
</span><span class="methodLine"><i>0684</i>             trailer.setLong(COSName.PREV, doc.getStartXref());                                                         
</span><span class="methodLine"><i>0685</i>             if (hybridPrev <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7682</span>!=</span> <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 8456</span>-</span>1)                                                                                      
</span><span class="methodLine"><i>0686</i>             {                                                                                                          
</span><span class="methodLine"><i>0687</i>                 COSName xrefStm = COSName.XREF_STM;                                                                    
</span><span class="methodLine"><i>0688</i>                 trailer.removeItem(xrefStm);                                                                           
</span><span class="methodLine"><i>0689</i>                 trailer.setLong(xrefStm, getStartxref());                                                              
</span><span class="methodLine"><i>0690</i>             }                                                                                                          
</span><span class="methodLine"><i>0691</i>             doWriteXRefTable();                                                                                        
</span><span class="methodLine"><i>0692</i>             doWriteTrailer(doc);                                                                                       
</span><span class="methodLine"><i>0693</i>         }                                                                                                              
</span><span class="methodLine"><i>0694</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0695</i>                                                                                                                        
</span><span class="outsideLine"><i>0696</i>     // writes the "xref" table                                                                                         
</span><span class="outsideLine"><i>0697</i>     private void doWriteXRefTable() throws IOException                                                                 
</span><span class="methodLine"><i>0698</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1635</span>{                                                                                                                  
</span><span class="methodLine"><i>0699</i>         addXRefEntry(COSWriterXRefEntry.getNullEntry());                                                               
</span><span class="outsideLine"><i>0700</i>                                                                                                                        
</span><span class="outsideLine"><i>0701</i>         // sort xref, needed only if object keys not regenerated                                                       
</span><span class="methodLine"><i>0702</i>         Collections.sort(getXRefEntries());                                                                            
</span><span class="outsideLine"><i>0703</i>                                                                                                                        
</span><span class="outsideLine"><i>0704</i>         // remember the position where x ref was written                                                               
</span><span class="methodLine"><i>0705</i>         setStartxref(getStandardOutput().getPos());                                                                    
</span><span class="outsideLine"><i>0706</i>                                                                                                                        
</span><span class="methodLine"><i>0707</i>         getStandardOutput().write(XREF);                                                                               
</span><span class="methodLine"><i>0708</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="outsideLine"><i>0709</i>         // write start object number and object count for this x ref section                                           
</span><span class="outsideLine"><i>0710</i>         // we assume starting from scratch                                                                             
</span><span class="outsideLine"><i>0711</i>                                                                                                                        
</span><span class="methodLine"><i>0712</i>         Long[] xRefRanges = getXRefRanges(getXRefEntries());                                                           
</span><span class="methodLine"><i>0713</i>         int xRefLength = xRefRanges.length;                                                                            
</span><span class="methodLine"><i>0714</i>         int x = 0;                                                                                                     
</span><span class="methodLine"><i>0715</i>         int j = 0;                                                                                                     
</span><span class="methodLine"><i>0716</i>         if ((xRefLength <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: / 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 6882</span>%</span> 2) <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4315</span>==</span> 0)                                                                                     
</span><span class="methodLine"><i>0717</i>         {                                                                                                              
</span><span class="methodLine"><i>0718</i>             while (x <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: >= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7712</span><</span> xRefLength)                                                                                     
</span><span class="methodLine"><i>0719</i>             {                                                                                                          
</span><span class="methodLine"><i>0720</i>                 writeXrefRange(xRefRanges[x], xRefRanges[x <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 11671</span>+</span> 1]);                                                      
</span><span class="outsideLine"><i>0721</i>                                                                                                                        
</span><span class="methodLine"><i>0722</i>                 for (int i = 0; i <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: >= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 10490</span><</span> xRefRanges[x <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 11348</span>+</span> 1]; <span class="ArithmeticOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -- 
Mutation Operator Type: ArithmeticOperatorReplacementShortcut 
Node ID: 11350</span>++</span>i)                                                            
</span><span class="methodLine"><i>0723</i>                 {                                                                                                      
</span><span class="methodLine"><i>0724</i>                     writeXrefEntry(xRefEntries.get(j<span class="ArithmeticOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -- 
Mutation Operator Type: ArithmeticOperatorReplacementShortcut 
Node ID: 12657</span>++</span>));                                                              
</span><span class="methodLine"><i>0725</i>                 }                                                                                                      
</span><span class="methodLine"><i>0726</i>                 x <span class="AssignmentOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -= 
Mutation Operator Type: AssignmentOperatorReplacementShortcut 
Node ID: 10494</span>+=</span> 2;                                                                                                
</span><span class="methodLine"><i>0727</i>             }                                                                                                          
</span><span class="methodLine"><i>0728</i>         }                                                                                                              
</span><span class="methodLine"><i>0729</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0730</i>                                                                                                                        
</span><span class="outsideLine"><i>0731</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0732</i>      * Write an incremental update for a non signature case. This can be used for e.g. augmenting                      
</span><span class="outsideLine"><i>0733</i>      * signatures.                                                                                                     
</span><span class="outsideLine"><i>0734</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0735</i>      * @throws IOException                                                                                             
</span><span class="outsideLine"><i>0736</i>      */                                                                                                                
</span><span class="outsideLine"><i>0737</i>     private void doWriteIncrement() throws IOException                                                                 
</span><span class="methodLine"><i>0738</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1642</span>{                                                                                                                  
</span><span class="outsideLine"><i>0739</i>         // write existing PDF                                                                                          
</span><span class="methodLine"><i>0740</i>         IOUtils.copy(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6890</span>new RandomAccessInputStream(incrementalInput)</span>, incrementalOutput);                                
</span><span class="outsideLine"><i>0741</i>         // write the actual incremental update                                                                         
</span><span class="methodLine"><i>0742</i>         incrementalOutput.write(((ByteArrayOutputStream) output).toByteArray());                                       
</span><span class="methodLine"><i>0743</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0744</i>                                                                                                                        
</span><span class="outsideLine"><i>0745</i>     private void doWriteSignature() throws IOException                                                                 
</span><span class="methodLine"><i>0746</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1649</span>{                                                                                                                  
</span><span class="outsideLine"><i>0747</i>         // calculate the ByteRange values                                                                              
</span><span class="methodLine"><i>0748</i>         long inLength = incrementalInput.length();                                                                     
</span><span class="methodLine"><i>0749</i>         long beforeLength = signatureOffset;                                                                           
</span><span class="methodLine"><i>0750</i>         long afterOffset = signatureOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 6901</span>+</span> signatureLength;                                                          
</span><span class="methodLine"><i>0751</i>         long afterLength = getStandardOutput().getPos() <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 7730</span>-</span> (inLength <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9956</span>+</span> signatureLength) <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 6903</span>-</span> (signatureOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9296</span>-</span> inLength); 
</span><span class="outsideLine"><i>0752</i>                                                                                                                        
</span><span class="methodLine"><i>0753</i>         String byteRange = "0 " + beforeLength + " " + afterOffset + " " + afterLength + "]";                          
</span><span class="outsideLine"><i>0754</i>                                                                                                                        
</span><span class="outsideLine"><i>0755</i>         // Assign the values to the actual COSArray, so that the user can access it before closing                     
</span><span class="methodLine"><i>0756</i>         byteRangeArray.set(0, COSInteger.ZERO);                                                                        
</span><span class="methodLine"><i>0757</i>         byteRangeArray.set(1, COSInteger.get(beforeLength));                                                           
</span><span class="methodLine"><i>0758</i>         byteRangeArray.set(2, COSInteger.get(afterOffset));                                                            
</span><span class="methodLine"><i>0759</i>         byteRangeArray.set(3, COSInteger.get(afterLength));                                                            
</span><span class="outsideLine"><i>0760</i>                                                                                                                        
</span><span class="methodLine"><i>0761</i>         if (byteRange.length() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4335</span>></span> byteRangeLength)                                                                      
</span><span class="methodLine"><i>0762</i>         {                                                                                                              
</span><span class="methodLine"><i>0763</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7759</span>new IOException("Can't write new byteRange '" + byteRange +                                          
</span><span class="methodLine"><i>0764</i>                     "' not enough space: byteRange.length(): " + byteRange.length() +                                  
</span><span class="methodLine"><i>0765</i>                     ", byteRangeLength: " + byteRangeLength)</span>;                                                          
</span><span class="methodLine"><i>0766</i>         }                                                                                                              
</span><span class="outsideLine"><i>0767</i>                                                                                                                        
</span><span class="outsideLine"><i>0768</i>         // copy the new incremental data into a buffer (e.g. signature dict, trailer)                                  
</span><span class="methodLine"><i>0769</i>         ByteArrayOutputStream byteOut = (ByteArrayOutputStream) output;                                                
</span><span class="methodLine"><i>0770</i>         byteOut.flush();                                                                                               
</span><span class="methodLine"><i>0771</i>         incrementPart = byteOut.toByteArray();                                                                         
</span><span class="outsideLine"><i>0772</i>                                                                                                                        
</span><span class="outsideLine"><i>0773</i>         // overwrite the reserve ByteRange in the buffer                                                               
</span><span class="methodLine"><i>0774</i>         byte[] byteRangeBytes = byteRange.getBytes(Charsets.ISO_8859_1);                                               
</span><span class="methodLine"><i>0775</i>         for (int i = 0; i <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: >= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4346</span><</span> byteRangeLength; i<span class="ArithmeticOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -- 
Mutation Operator Type: ArithmeticOperatorReplacementShortcut 
Node ID: 6024</span>++</span>)                                                                      
</span><span class="methodLine"><i>0776</i>         {                                                                                                              
</span><span class="methodLine"><i>0777</i>             if (i <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: < 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7776</span>>=</span> byteRangeBytes.length)                                                                            
</span><span class="methodLine"><i>0778</i>             {                                                                                                          
</span><span class="methodLine"><i>0779</i>                 incrementPart[(int) (byteRangeOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 12352</span>+</span> i <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 12171</span>-</span> inLength)] = 0x20; // SPACE                                 
</span><span class="methodLine"><i>0780</i>             }                                                                                                          
</span><span class="methodLine"><i>0781</i>             else                                                                                                       
</span><span class="methodLine"><i>0782</i>             {                                                                                                          
</span><span class="methodLine"><i>0783</i>                 incrementPart[(int) (byteRangeOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 12355</span>+</span> i <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 12175</span>-</span> inLength)] = byteRangeBytes[i];                             
</span><span class="methodLine"><i>0784</i>             }                                                                                                          
</span><span class="methodLine"><i>0785</i>         }                                                                                                              
</span><span class="outsideLine"><i>0786</i>                                                                                                                        
</span><span class="methodLine"><i>0787</i>         if(<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4351</span>signatureInterface <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4351</span>!=</span> null</span>)                                                                                 
</span><span class="methodLine"><i>0788</i>         {                                                                                                              
</span><span class="outsideLine"><i>0789</i>             // data to be signed                                                                                       
</span><span class="methodLine"><i>0790</i>             final InputStream dataToSign = getDataToSign();                                                            
</span><span class="outsideLine"><i>0791</i>                                                                                                                        
</span><span class="outsideLine"><i>0792</i>             // sign the bytes                                                                                          
</span><span class="methodLine"><i>0793</i>             byte[] signatureBytes = signatureInterface.sign(dataToSign);                                               
</span><span class="methodLine"><i>0794</i>             writeExternalSignature(signatureBytes);                                                                    
</span><span class="methodLine"><i>0795</i>         }                                                                                                              
</span><span class="outsideLine"><i>0796</i>         // else signature should created externally and set via writeSignature()                                       
</span><span class="methodLine"><i>0797</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0798</i>                                                                                                                        
</span><span class="outsideLine"><i>0799</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0800</i>      * Return the stream of PDF data to be signed. Clients should use this method only to create                       
</span><span class="outsideLine"><i>0801</i>      * signatures externally. {@link #write(PDDocument)} method should have been called prior.                         
</span><span class="outsideLine"><i>0802</i>      * The created signature should be set using {@link #writeExternalSignature(byte[])}.                              
</span><span class="outsideLine"><i>0803</i>      * <p>                                                                                                             
</span><span class="outsideLine"><i>0804</i>      * When {@link SignatureInterface} instance is used, COSWriter obtains and writes the signature itself.            
</span><span class="outsideLine"><i>0805</i>      * </p>                                                                                                            
</span><span class="outsideLine"><i>0806</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0807</i>      * @return data stream to be signed                                                                                
</span><span class="outsideLine"><i>0808</i>      * @throws IllegalStateException if PDF is not prepared for external signing                                       
</span><span class="outsideLine"><i>0809</i>      * @throws IOException if input data is closed                                                                     
</span><span class="outsideLine"><i>0810</i>      */                                                                                                                
</span><span class="outsideLine"><i>0811</i>     public InputStream getDataToSign() throws IOException                                                              
</span><span class="methodLine"><i>0812</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1656</span>{                                                                                                                  
</span><span class="methodLine"><i>0813</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5125</span>incrementPart <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5125</span>==</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4355</span>||</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5127</span>incrementalInput <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5127</span>==</span> null</span>)                                                         
</span><span class="methodLine"><i>0814</i>         {                                                                                                              
</span><span class="methodLine"><i>0815</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7792</span>new IllegalStateException("PDF not prepared for signing")</span>;                                           
</span><span class="methodLine"><i>0816</i>         }                                                                                                              
</span><span class="outsideLine"><i>0817</i>         // range of incremental bytes to be signed (includes /ByteRange but not /Contents)                             
</span><span class="methodLine"><i>0818</i>         int incPartSigOffset = (int) (signatureOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9338</span>-</span> incrementalInput.length());                                    
</span><span class="methodLine"><i>0819</i>         int afterSigOffset = incPartSigOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 6974</span>+</span> (int) signatureLength;                                                 
</span><span class="methodLine"><i>0820</i>         int[] range = {0, incPartSigOffset,                                                                            
</span><span class="methodLine"><i>0821</i>                 afterSigOffset, incrementPart.length <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 8566</span>-</span> afterSigOffset};                                                
</span><span class="outsideLine"><i>0822</i>                                                                                                                        
</span><span class="methodLine"><i>0823</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3130</span>return <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 4365</span>new SequenceInputStream(                                                                                
</span><span class="methodLine"><i>0824</i>                 <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8568</span>new RandomAccessInputStream(incrementalInput)</span>,                                                         
</span><span class="methodLine"><i>0825</i>                 <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8570</span>new COSFilterInputStream(incrementPart, range)</span>)</span>;</span>                                                       
</span><span class="methodLine"><i>0826</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0827</i>                                                                                                                        
</span><span class="outsideLine"><i>0828</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0829</i>      * Write externally created signature of PDF data obtained via {@link #getDataToSign()} method.                    
</span><span class="outsideLine"><i>0830</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0831</i>      * @param cmsSignature CMS signature byte array                                                                    
</span><span class="outsideLine"><i>0832</i>      * @throws IllegalStateException if PDF is not prepared for external signing                                       
</span><span class="outsideLine"><i>0833</i>      * @throws IOException if source data stream is closed                                                             
</span><span class="outsideLine"><i>0834</i>      */                                                                                                                
</span><span class="methodLine"><i>0835</i>     public void writeExternalSignature(byte[] cmsSignature) throws IOException <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1663</span>{                                       
</span><span class="outsideLine"><i>0836</i>                                                                                                                        
</span><span class="methodLine"><i>0837</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5141</span>incrementPart <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5141</span>==</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4368</span>||</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5143</span>incrementalInput <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5143</span>==</span> null</span>)                                                         
</span><span class="methodLine"><i>0838</i>         {                                                                                                              
</span><span class="methodLine"><i>0839</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7817</span>new IllegalStateException("PDF not prepared for setting signature")</span>;                                 
</span><span class="methodLine"><i>0840</i>         }                                                                                                              
</span><span class="methodLine"><i>0841</i>         byte[] signatureBytes = Hex.getBytes(cmsSignature);                                                            
</span><span class="outsideLine"><i>0842</i>                                                                                                                        
</span><span class="outsideLine"><i>0843</i>         // subtract 2 bytes because of the enclosing "<>"                                                              
</span><span class="methodLine"><i>0844</i>         if (signatureBytes.length <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4374</span>></span> signatureLength <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 5153</span>-</span> 2)                                                               
</span><span class="methodLine"><i>0845</i>         {                                                                                                              
</span><span class="methodLine"><i>0846</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7826</span>new IOException("Can't write signature, not enough space")</span>;                                          
</span><span class="methodLine"><i>0847</i>         }                                                                                                              
</span><span class="outsideLine"><i>0848</i>                                                                                                                        
</span><span class="outsideLine"><i>0849</i>         // overwrite the signature Contents in the buffer                                                              
</span><span class="methodLine"><i>0850</i>         int incPartSigOffset = (int) (signatureOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9361</span>-</span> incrementalInput.length());                                    
</span><span class="methodLine"><i>0851</i>         System.arraycopy(signatureBytes, 0, incrementPart, incPartSigOffset <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 6083</span>+</span> 1, signatureBytes.length);               
</span><span class="outsideLine"><i>0852</i>                                                                                                                        
</span><span class="outsideLine"><i>0853</i>         // write the data to the incremental output stream                                                             
</span><span class="methodLine"><i>0854</i>         IOUtils.copy(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7009</span>new RandomAccessInputStream(incrementalInput)</span>, incrementalOutput);                                
</span><span class="methodLine"><i>0855</i>         incrementalOutput.write(incrementPart);                                                                        
</span><span class="outsideLine"><i>0856</i>                                                                                                                        
</span><span class="outsideLine"><i>0857</i>         // prevent further use                                                                                         
</span><span class="methodLine"><i>0858</i>         incrementPart = null;                                                                                          
</span><span class="methodLine"><i>0859</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0860</i>                                                                                                                        
</span><span class="outsideLine"><i>0861</i>     private void writeXrefRange(long x, long y) throws IOException                                                     
</span><span class="methodLine"><i>0862</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1670</span>{                                                                                                                  
</span><span class="methodLine"><i>0863</i>         getStandardOutput().write(String.valueOf(x).getBytes(Charsets.ISO_8859_1));                                    
</span><span class="methodLine"><i>0864</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>0865</i>         getStandardOutput().write(String.valueOf(y).getBytes(Charsets.ISO_8859_1));                                    
</span><span class="methodLine"><i>0866</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>0867</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0868</i>                                                                                                                        
</span><span class="outsideLine"><i>0869</i>     private void writeXrefEntry(COSWriterXRefEntry entry) throws IOException                                           
</span><span class="methodLine"><i>0870</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1677</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0871</i>         String offset = formatXrefOffset.format(entry.getOffset());                                                    
</span><span class="methodLine"><i>0872</i>         String generation = formatXrefGeneration.format(entry.getKey().getGeneration());                               
</span><span class="methodLine"><i>0873</i>         getStandardOutput().write(offset.getBytes(Charsets.ISO_8859_1));                                               
</span><span class="methodLine"><i>0874</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>0875</i>         getStandardOutput().write(generation.getBytes(Charsets.ISO_8859_1));                                           
</span><span class="methodLine"><i>0876</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>0877</i>         getStandardOutput().write(entry.isFree() ? XREF_FREE : XREF_USED);                                             
</span><span class="methodLine"><i>0878</i>         getStandardOutput().writeCRLF();                                                                               
</span><span class="methodLine"><i>0879</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0880</i>                                                                                                                        
</span><span class="outsideLine"><i>0881</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0882</i>      * check the xref entries and write out the ranges.  The format of the                                             
</span><span class="outsideLine"><i>0883</i>      * returned array is exactly the same as the pdf specification.  See section                                       
</span><span class="outsideLine"><i>0884</i>      * 7.5.4 of ISO32000-1:2008, example 1 (page 40) for reference.                                                    
</span><span class="outsideLine"><i>0885</i>      * <p>                                                                                                             
</span><span class="outsideLine"><i>0886</i>      * example: 0 1 2 5 6 7 8 10                                                                                       
</span><span class="outsideLine"><i>0887</i>      * <p>                                                                                                             
</span><span class="outsideLine"><i>0888</i>      * will create a array with follow ranges                                                                          
</span><span class="outsideLine"><i>0889</i>      * <p>                                                                                                             
</span><span class="outsideLine"><i>0890</i>      * 0 3 5 4 10 1                                                                                                    
</span><span class="outsideLine"><i>0891</i>      * <p>                                                                                                             
</span><span class="outsideLine"><i>0892</i>      * this mean that the element 0 is followed by two other related numbers                                           
</span><span class="outsideLine"><i>0893</i>      * that represent a cluster of the size 3. 5 is follow by three other                                              
</span><span class="outsideLine"><i>0894</i>      * related numbers and create a cluster of size 4. etc.                                                            
</span><span class="outsideLine"><i>0895</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0896</i>      * @param xRefEntriesList list with the xRef entries that was written                                              
</span><span class="outsideLine"><i>0897</i>      * @return a integer array with the ranges                                                                         
</span><span class="outsideLine"><i>0898</i>      */                                                                                                                
</span><span class="outsideLine"><i>0899</i>     protected Long[] getXRefRanges(List<COSWriterXRefEntry> xRefEntriesList)                                           
</span><span class="methodLine"><i>0900</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1682</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0901</i>         long last = <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 7075</span>-</span>2;                                                                                                
</span><span class="methodLine"><i>0902</i>         long count = 1;                                                                                                
</span><span class="outsideLine"><i>0903</i>                                                                                                                        
</span><span class="methodLine"><i>0904</i>         List<Long> list = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7893</span>new ArrayList<Long>()</span>;                                                                       
</span><span class="methodLine"><i>0905</i>         for (COSWriterXRefEntry object : xRefEntriesList)                                                              
</span><span class="methodLine"><i>0906</i>         {                                                                                                              
</span><span class="methodLine"><i>0907</i>             long nr = object.getKey().getNumber();                                                                     
</span><span class="methodLine"><i>0908</i>             if (nr <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7897</span>==</span> last <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 8645</span>+</span> 1)                                                                                        
</span><span class="methodLine"><i>0909</i>             {                                                                                                          
</span><span class="methodLine"><i>0910</i>                 <span class="ArithmeticOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -- 
Mutation Operator Type: ArithmeticOperatorReplacementShortcut 
Node ID: 10562</span>++</span>count;                                                                                               
</span><span class="methodLine"><i>0911</i>                 last = nr;                                                                                             
</span><span class="methodLine"><i>0912</i>             }                                                                                                          
</span><span class="methodLine"><i>0913</i>             else if (last <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8651</span>==</span> <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 9408</span>-</span>2)                                                                                       
</span><span class="methodLine"><i>0914</i>             {                                                                                                          
</span><span class="methodLine"><i>0915</i>                 last = nr;                                                                                             
</span><span class="methodLine"><i>0916</i>             }                                                                                                          
</span><span class="methodLine"><i>0917</i>             else                                                                                                       
</span><span class="methodLine"><i>0918</i>             {                                                                                                          
</span><span class="methodLine"><i>0919</i>                 list.add(last <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 11979</span>-</span> count <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 11730</span>+</span> 1);                                                                            
</span><span class="methodLine"><i>0920</i>                 list.add(count);                                                                                       
</span><span class="methodLine"><i>0921</i>                 last = nr;                                                                                             
</span><span class="methodLine"><i>0922</i>                 count = 1;                                                                                             
</span><span class="methodLine"><i>0923</i>             }                                                                                                          
</span><span class="methodLine"><i>0924</i>         }                                                                                                              
</span><span class="outsideLine"><i>0925</i>         // If no new entry is found, we need to write out the last result                                              
</span><span class="methodLine"><i>0926</i>         if(xRefEntriesList.size() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4411</span>></span> 0)                                                                                 
</span><span class="methodLine"><i>0927</i>         {                                                                                                              
</span><span class="methodLine"><i>0928</i>             list.add(last <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 10056</span>-</span> count <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9421</span>+</span> 1);                                                                                
</span><span class="methodLine"><i>0929</i>             list.add(count);                                                                                           
</span><span class="methodLine"><i>0930</i>         }                                                                                                              
</span><span class="methodLine"><i>0931</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3166</span>return list.toArray(new Long[list.size()]);</span>                                                                    
</span><span class="methodLine"><i>0932</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0933</i>                                                                                                                        
</span><span class="outsideLine"><i>0934</i>     /**                                                                                                                
</span><span class="outsideLine"><i>0935</i>      * This will get the object key for the object.                                                                    
</span><span class="outsideLine"><i>0936</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0937</i>      * @param obj The object to get the key for.                                                                       
</span><span class="outsideLine"><i>0938</i>      *                                                                                                                 
</span><span class="outsideLine"><i>0939</i>      * @return The object key for the object.                                                                          
</span><span class="outsideLine"><i>0940</i>      */                                                                                                                
</span><span class="outsideLine"><i>0941</i>     private COSObjectKey getObjectKey( COSBase obj )                                                                   
</span><span class="methodLine"><i>0942</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1687</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0943</i>         COSBase actual = obj;                                                                                          
</span><span class="methodLine"><i>0944</i>         if( actual instanceof COSObject )                                                                              
</span><span class="methodLine"><i>0945</i>         {                                                                                                              
</span><span class="methodLine"><i>0946</i>             actual = ((COSObject)obj).getObject();                                                                     
</span><span class="methodLine"><i>0947</i>         }                                                                                                              
</span><span class="outsideLine"><i>0948</i>         // PDFBOX-4540: because objectKeys is accessible from outside, it is possible                                  
</span><span class="outsideLine"><i>0949</i>         // that a COSObject obj is already in the objectKeys map.                                                      
</span><span class="methodLine"><i>0950</i>         COSObjectKey key = objectKeys.get(obj);                                                                        
</span><span class="methodLine"><i>0951</i>         if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5254</span>key <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5254</span>==</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4428</span>&&</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5256</span>actual <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5256</span>!=</span> null</span> )                                                                            
</span><span class="methodLine"><i>0952</i>         {                                                                                                              
</span><span class="methodLine"><i>0953</i>             key = objectKeys.get(actual);                                                                              
</span><span class="methodLine"><i>0954</i>         }                                                                                                              
</span><span class="methodLine"><i>0955</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4432</span>key <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4432</span>==</span> null</span>)                                                                                               
</span><span class="methodLine"><i>0956</i>         {                                                                                                              
</span><span class="methodLine"><i>0957</i>             setNumber(getNumber()<span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 9441</span>+</span>1);                                                                                  
</span><span class="methodLine"><i>0958</i>             key = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9444</span>new COSObjectKey(getNumber(),0)</span>;                                                                     
</span><span class="methodLine"><i>0959</i>             objectKeys.put(obj, key);                                                                                  
</span><span class="methodLine"><i>0960</i>             if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7929</span>actual <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7929</span>!=</span> null</span> )                                                                                       
</span><span class="methodLine"><i>0961</i>             {                                                                                                          
</span><span class="methodLine"><i>0962</i>                 objectKeys.put(actual, key);                                                                           
</span><span class="methodLine"><i>0963</i>             }                                                                                                          
</span><span class="methodLine"><i>0964</i>         }                                                                                                              
</span><span class="methodLine"><i>0965</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3174</span>return key;</span>                                                                                                    
</span><span class="methodLine"><i>0966</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>0967</i>                                                                                                                        
</span><span class="outsideLine"><i>0968</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>0969</i>     public Object visitFromArray( COSArray obj ) throws IOException                                                    
</span><span class="methodLine"><i>0970</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1695</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>0971</i>         int count = 0;                                                                                                 
</span><span class="methodLine"><i>0972</i>         getStandardOutput().write(ARRAY_OPEN);                                                                         
</span><span class="methodLine"><i>0973</i>         for (Iterator<COSBase> i = obj.iterator(); i.hasNext();)                                                       
</span><span class="methodLine"><i>0974</i>         {                                                                                                              
</span><span class="methodLine"><i>0975</i>             COSBase current = i.next();                                                                                
</span><span class="methodLine"><i>0976</i>             if( current instanceof COSDictionary )                                                                     
</span><span class="methodLine"><i>0977</i>             {                                                                                                          
</span><span class="methodLine"><i>0978</i>                 if (current.isDirect())                                                                                
</span><span class="methodLine"><i>0979</i>                 {                                                                                                      
</span><span class="methodLine"><i>0980</i>                     visitFromDictionary((COSDictionary)current);                                                       
</span><span class="methodLine"><i>0981</i>                 }                                                                                                      
</span><span class="methodLine"><i>0982</i>                 else                                                                                                   
</span><span class="methodLine"><i>0983</i>                 {                                                                                                      
</span><span class="methodLine"><i>0984</i>                     addObjectToWrite( current );                                                                       
</span><span class="methodLine"><i>0985</i>                     writeReference( current );                                                                         
</span><span class="methodLine"><i>0986</i>                 }                                                                                                      
</span><span class="methodLine"><i>0987</i>             }                                                                                                          
</span><span class="methodLine"><i>0988</i>             else if( current instanceof COSObject )                                                                    
</span><span class="methodLine"><i>0989</i>             {                                                                                                          
</span><span class="methodLine"><i>0990</i>                 COSBase subValue = ((COSObject)current).getObject();                                                   
</span><span class="methodLine"><i>0991</i>                 if (willEncrypt <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 11760</span>||</span> incrementalUpdate <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 11441</span>||</span> subValue instanceof COSDictionary <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 11048</span>||</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 11443</span>subValue <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 11443</span>==</span> null</span>)         
</span><span class="methodLine"><i>0992</i>                 {                                                                                                      
</span><span class="outsideLine"><i>0993</i>                     // PDFBOX-4308: added willEncrypt to prevent an object                                             
</span><span class="outsideLine"><i>0994</i>                     // that is referenced several times from being written                                             
</span><span class="outsideLine"><i>0995</i>                     // direct and indirect, thus getting encrypted                                                     
</span><span class="outsideLine"><i>0996</i>                     // with wrong object number or getting encrypted twice                                             
</span><span class="methodLine"><i>0997</i>                     addObjectToWrite( current );                                                                       
</span><span class="methodLine"><i>0998</i>                     writeReference( current );                                                                         
</span><span class="methodLine"><i>0999</i>                 }                                                                                                      
</span><span class="methodLine"><i>1000</i>                 else                                                                                                   
</span><span class="methodLine"><i>1001</i>                 {                                                                                                      
</span><span class="methodLine"><i>1002</i>                     subValue.accept( this );                                                                           
</span><span class="methodLine"><i>1003</i>                 }                                                                                                      
</span><span class="methodLine"><i>1004</i>             }                                                                                                          
</span><span class="methodLine"><i>1005</i>             else if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 9474</span>current <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 9474</span>==</span> null</span> )                                                                                 
</span><span class="methodLine"><i>1006</i>             {                                                                                                          
</span><span class="methodLine"><i>1007</i>                 COSNull.NULL.accept( this );                                                                           
</span><span class="methodLine"><i>1008</i>             }                                                                                                          
</span><span class="methodLine"><i>1009</i>             else                                                                                                       
</span><span class="methodLine"><i>1010</i>             {                                                                                                          
</span><span class="methodLine"><i>1011</i>                 current.accept(this);                                                                                  
</span><span class="methodLine"><i>1012</i>             }                                                                                                          
</span><span class="methodLine"><i>1013</i>             count<span class="ArithmeticOperatorReplacementShortcut tooltip"><span class="tooltiptext">Mutated Text: -- 
Mutation Operator Type: ArithmeticOperatorReplacementShortcut 
Node ID: 7952</span>++</span>;                                                                                                   
</span><span class="methodLine"><i>1014</i>             if (i.hasNext())                                                                                           
</span><span class="methodLine"><i>1015</i>             {                                                                                                          
</span><span class="methodLine"><i>1016</i>                 if (count <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: / 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 11058</span>%</span> 10 <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 10623</span>==</span> 0)                                                                                   
</span><span class="methodLine"><i>1017</i>                 {                                                                                                      
</span><span class="methodLine"><i>1018</i>                     getStandardOutput().writeEOL();                                                                    
</span><span class="methodLine"><i>1019</i>                 }                                                                                                      
</span><span class="methodLine"><i>1020</i>                 else                                                                                                   
</span><span class="methodLine"><i>1021</i>                 {                                                                                                      
</span><span class="methodLine"><i>1022</i>                     getStandardOutput().write(SPACE);                                                                  
</span><span class="methodLine"><i>1023</i>                 }                                                                                                      
</span><span class="methodLine"><i>1024</i>             }                                                                                                          
</span><span class="methodLine"><i>1025</i>         }                                                                                                              
</span><span class="methodLine"><i>1026</i>         getStandardOutput().write(ARRAY_CLOSE);                                                                        
</span><span class="methodLine"><i>1027</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>1028</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3183</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1029</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1030</i>                                                                                                                        
</span><span class="outsideLine"><i>1031</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1032</i>     public Object visitFromBoolean(COSBoolean obj) throws IOException                                                  
</span><span class="methodLine"><i>1033</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1703</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1034</i>         obj.writePDF( getStandardOutput() );                                                                           
</span><span class="methodLine"><i>1035</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3188</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1036</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1037</i>                                                                                                                        
</span><span class="outsideLine"><i>1038</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1039</i>     public Object visitFromDictionary(COSDictionary obj) throws IOException                                            
</span><span class="methodLine"><i>1040</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1711</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1041</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4453</span>!</span>reachedSignature)                                                                                         
</span><span class="methodLine"><i>1042</i>         {                                                                                                              
</span><span class="methodLine"><i>1043</i>             COSBase itemType = obj.getItem(COSName.TYPE);                                                              
</span><span class="methodLine"><i>1044</i>             if (COSName.SIG.equals(itemType) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 7965</span>||</span> COSName.DOC_TIME_STAMP.equals(itemType))                               
</span><span class="methodLine"><i>1045</i>             {                                                                                                          
</span><span class="methodLine"><i>1046</i>                 reachedSignature = true;                                                                               
</span><span class="methodLine"><i>1047</i>             }                                                                                                          
</span><span class="methodLine"><i>1048</i>         }                                                                                                              
</span><span class="methodLine"><i>1049</i>         getStandardOutput().write(DICT_OPEN);                                                                          
</span><span class="methodLine"><i>1050</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>1051</i>         for (Map.Entry<COSName, COSBase> entry : obj.entrySet())                                                       
</span><span class="methodLine"><i>1052</i>         {                                                                                                              
</span><span class="methodLine"><i>1053</i>             COSBase value = entry.getValue();                                                                          
</span><span class="methodLine"><i>1054</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7980</span>value <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7980</span>!=</span> null</span>)                                                                                         
</span><span class="methodLine"><i>1055</i>             {                                                                                                          
</span><span class="methodLine"><i>1056</i>                 entry.getKey().accept(this);                                                                           
</span><span class="methodLine"><i>1057</i>                 getStandardOutput().write(SPACE);                                                                      
</span><span class="methodLine"><i>1058</i>                 if( value instanceof COSDictionary )                                                                   
</span><span class="methodLine"><i>1059</i>                 {                                                                                                      
</span><span class="methodLine"><i>1060</i>                     COSDictionary dict = (COSDictionary)value;                                                         
</span><span class="outsideLine"><i>1061</i>                                                                                                                        
</span><span class="methodLine"><i>1062</i>                     if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 12039</span>!</span>incrementalUpdate)                                                                            
</span><span class="methodLine"><i>1063</i>                     {                                                                                                  
</span><span class="outsideLine"><i>1064</i>                         // write all XObjects as direct objects, this will save some size                              
</span><span class="outsideLine"><i>1065</i>                         // PDFBOX-3684: but avoid dictionary that references itself                                    
</span><span class="methodLine"><i>1066</i>                         COSBase item = dict.getItem(COSName.XOBJECT);                                                  
</span><span class="methodLine"><i>1067</i>                         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 12806</span>item <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12806</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12688</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 12808</span>!</span>COSName.XOBJECT.equals(entry.getKey()))                                   
</span><span class="methodLine"><i>1068</i>                         {                                                                                              
</span><span class="methodLine"><i>1069</i>                             item.setDirect(true);                                                                      
</span><span class="methodLine"><i>1070</i>                         }                                                                                              
</span><span class="methodLine"><i>1071</i>                         item = dict.getItem(COSName.RESOURCES);                                                        
</span><span class="methodLine"><i>1072</i>                         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 12815</span>item <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12815</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12693</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 12817</span>!</span>COSName.RESOURCES.equals(entry.getKey()))                                 
</span><span class="methodLine"><i>1073</i>                         {                                                                                              
</span><span class="methodLine"><i>1074</i>                             item.setDirect(true);                                                                      
</span><span class="methodLine"><i>1075</i>                         }                                                                                              
</span><span class="methodLine"><i>1076</i>                     }                                                                                                  
</span><span class="outsideLine"><i>1077</i>                                                                                                                        
</span><span class="methodLine"><i>1078</i>                     if(dict.isDirect())                                                                                
</span><span class="methodLine"><i>1079</i>                     {                                                                                                  
</span><span class="outsideLine"><i>1080</i>                         // If the object should be written direct, we need                                             
</span><span class="outsideLine"><i>1081</i>                         // to pass the dictionary to the visitor again.                                                
</span><span class="methodLine"><i>1082</i>                         visitFromDictionary(dict);                                                                     
</span><span class="methodLine"><i>1083</i>                     }                                                                                                  
</span><span class="methodLine"><i>1084</i>                     else                                                                                               
</span><span class="methodLine"><i>1085</i>                     {                                                                                                  
</span><span class="methodLine"><i>1086</i>                         addObjectToWrite( dict );                                                                      
</span><span class="methodLine"><i>1087</i>                         writeReference( dict );                                                                        
</span><span class="methodLine"><i>1088</i>                     }                                                                                                  
</span><span class="methodLine"><i>1089</i>                 }                                                                                                      
</span><span class="methodLine"><i>1090</i>                 else if( value instanceof COSObject )                                                                  
</span><span class="methodLine"><i>1091</i>                 {                                                                                                      
</span><span class="methodLine"><i>1092</i>                     COSBase subValue = ((COSObject)value).getObject();                                                 
</span><span class="methodLine"><i>1093</i>                     if (willEncrypt <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12565</span>||</span> incrementalUpdate <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12416</span>||</span> subValue instanceof COSDictionary <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12251</span>||</span> <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 12418</span>subValue <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 12418</span>==</span> null</span>)     
</span><span class="methodLine"><i>1094</i>                     {                                                                                                  
</span><span class="outsideLine"><i>1095</i>                         // PDFBOX-4308: added willEncrypt to prevent an object                                         
</span><span class="outsideLine"><i>1096</i>                         // that is referenced several times from being written                                         
</span><span class="outsideLine"><i>1097</i>                         // direct and indirect, thus getting encrypted                                                 
</span><span class="outsideLine"><i>1098</i>                         // with wrong object number or getting encrypted twice                                         
</span><span class="methodLine"><i>1099</i>                         addObjectToWrite( value );                                                                     
</span><span class="methodLine"><i>1100</i>                         writeReference( value );                                                                       
</span><span class="methodLine"><i>1101</i>                     }                                                                                                  
</span><span class="methodLine"><i>1102</i>                     else                                                                                               
</span><span class="methodLine"><i>1103</i>                     {                                                                                                  
</span><span class="methodLine"><i>1104</i>                         subValue.accept( this );                                                                       
</span><span class="methodLine"><i>1105</i>                     }                                                                                                  
</span><span class="methodLine"><i>1106</i>                 }                                                                                                      
</span><span class="methodLine"><i>1107</i>                 else                                                                                                   
</span><span class="methodLine"><i>1108</i>                 {                                                                                                      
</span><span class="outsideLine"><i>1109</i>                     // If we reach the pdf signature, we need to determinate the position of the                       
</span><span class="outsideLine"><i>1110</i>                     // content and byterange                                                                           
</span><span class="methodLine"><i>1111</i>                     if(reachedSignature <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12256</span>&&</span> COSName.CONTENTS.equals(entry.getKey()))                                    
</span><span class="methodLine"><i>1112</i>                     {                                                                                                  
</span><span class="methodLine"><i>1113</i>                         signatureOffset = getStandardOutput().getPos();                                                
</span><span class="methodLine"><i>1114</i>                         value.accept(this);                                                                            
</span><span class="methodLine"><i>1115</i>                         signatureLength = getStandardOutput().getPos()<span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 12969</span>-</span> signatureOffset;                               
</span><span class="methodLine"><i>1116</i>                     }                                                                                                  
</span><span class="methodLine"><i>1117</i>                     else if(reachedSignature <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 12435</span>&&</span> COSName.BYTERANGE.equals(entry.getKey()))                              
</span><span class="methodLine"><i>1118</i>                     {                                                                                                  
</span><span class="methodLine"><i>1119</i>                         byteRangeArray = (COSArray) entry.getValue();                                                  
</span><span class="methodLine"><i>1120</i>                         byteRangeOffset = getStandardOutput().getPos() <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: - 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 13067</span>+</span> 1;                                            
</span><span class="methodLine"><i>1121</i>                         value.accept(this);                                                                            
</span><span class="methodLine"><i>1122</i>                         byteRangeLength = getStandardOutput().getPos() <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 13160</span>-</span> 1 <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 13074</span>-</span> byteRangeOffset;                          
</span><span class="methodLine"><i>1123</i>                         reachedSignature = false;                                                                      
</span><span class="methodLine"><i>1124</i>                     }                                                                                                  
</span><span class="methodLine"><i>1125</i>                     else                                                                                               
</span><span class="methodLine"><i>1126</i>                     {                                                                                                  
</span><span class="methodLine"><i>1127</i>                         value.accept(this);                                                                            
</span><span class="methodLine"><i>1128</i>                     }                                                                                                  
</span><span class="methodLine"><i>1129</i>                 }                                                                                                      
</span><span class="methodLine"><i>1130</i>                 getStandardOutput().writeEOL();                                                                        
</span><span class="outsideLine"><i>1131</i>                                                                                                                        
</span><span class="methodLine"><i>1132</i>             }                                                                                                          
</span><span class="methodLine"><i>1133</i>             else                                                                                                       
</span><span class="methodLine"><i>1134</i>             {                                                                                                          
</span><span class="outsideLine"><i>1135</i>                 //then we won't write anything, there are a couple cases                                               
</span><span class="outsideLine"><i>1136</i>                 //were the value of an entry in the COSDictionary will                                                 
</span><span class="outsideLine"><i>1137</i>                 //be a dangling reference that points to nothing                                                       
</span><span class="outsideLine"><i>1138</i>                 //so we will just not write out the entry if that is the case                                          
</span><span class="methodLine"><i>1139</i>             }                                                                                                          
</span><span class="methodLine"><i>1140</i>         }                                                                                                              
</span><span class="methodLine"><i>1141</i>         getStandardOutput().write(DICT_CLOSE);                                                                         
</span><span class="methodLine"><i>1142</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>1143</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3198</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1144</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1145</i>                                                                                                                        
</span><span class="outsideLine"><i>1146</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1147</i>     public Object visitFromDocument(COSDocument doc) throws IOException                                                
</span><span class="methodLine"><i>1148</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1719</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1149</i>         if(<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4465</span>!</span>incrementalUpdate)                                                                                         
</span><span class="methodLine"><i>1150</i>         {                                                                                                              
</span><span class="methodLine"><i>1151</i>             doWriteHeader(doc);                                                                                        
</span><span class="methodLine"><i>1152</i>         }                                                                                                              
</span><span class="methodLine"><i>1153</i>         else                                                                                                           
</span><span class="methodLine"><i>1154</i>         {                                                                                                              
</span><span class="outsideLine"><i>1155</i>             // Sometimes the original file will be missing a newline at the end                                        
</span><span class="outsideLine"><i>1156</i>             // In order to avoid having %%EOF the first object on the same line                                        
</span><span class="outsideLine"><i>1157</i>             // as the %%EOF, we put a newline here. If there's already one at                                          
</span><span class="outsideLine"><i>1158</i>             // the end of the file, an extra one won't hurt. PDFBOX-1051                                               
</span><span class="methodLine"><i>1159</i>             getStandardOutput().writeCRLF();                                                                           
</span><span class="methodLine"><i>1160</i>         }                                                                                                              
</span><span class="outsideLine"><i>1161</i>                                                                                                                        
</span><span class="methodLine"><i>1162</i>         doWriteBody(doc);                                                                                              
</span><span class="outsideLine"><i>1163</i>                                                                                                                        
</span><span class="outsideLine"><i>1164</i>         // get the previous trailer                                                                                    
</span><span class="methodLine"><i>1165</i>         COSDictionary trailer = doc.getTrailer();                                                                      
</span><span class="methodLine"><i>1166</i>         long hybridPrev = <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 7204</span>-</span>1;                                                                                          
</span><span class="outsideLine"><i>1167</i>                                                                                                                        
</span><span class="methodLine"><i>1168</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4475</span>trailer <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4475</span>!=</span> null</span>)                                                                                           
</span><span class="methodLine"><i>1169</i>         {                                                                                                              
</span><span class="methodLine"><i>1170</i>             hybridPrev = trailer.getLong(COSName.XREF_STM);                                                            
</span><span class="methodLine"><i>1171</i>         }                                                                                                              
</span><span class="outsideLine"><i>1172</i>                                                                                                                        
</span><span class="methodLine"><i>1173</i>         if(incrementalUpdate <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4479</span>||</span> doc.isXRefStream())                                                                    
</span><span class="methodLine"><i>1174</i>         {                                                                                                              
</span><span class="methodLine"><i>1175</i>             doWriteXRefInc(doc, hybridPrev);                                                                           
</span><span class="methodLine"><i>1176</i>         }                                                                                                              
</span><span class="methodLine"><i>1177</i>         else                                                                                                           
</span><span class="methodLine"><i>1178</i>         {                                                                                                              
</span><span class="methodLine"><i>1179</i>             doWriteXRefTable();                                                                                        
</span><span class="methodLine"><i>1180</i>             doWriteTrailer(doc);                                                                                       
</span><span class="methodLine"><i>1181</i>         }                                                                                                              
</span><span class="outsideLine"><i>1182</i>                                                                                                                        
</span><span class="outsideLine"><i>1183</i>         // write endof                                                                                                 
</span><span class="methodLine"><i>1184</i>         getStandardOutput().write(STARTXREF);                                                                          
</span><span class="methodLine"><i>1185</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>1186</i>         getStandardOutput().write(String.valueOf(getStartxref()).getBytes(Charsets.ISO_8859_1));                       
</span><span class="methodLine"><i>1187</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="methodLine"><i>1188</i>         getStandardOutput().write(EOF);                                                                                
</span><span class="methodLine"><i>1189</i>         getStandardOutput().writeEOL();                                                                                
</span><span class="outsideLine"><i>1190</i>                                                                                                                        
</span><span class="methodLine"><i>1191</i>         if (incrementalUpdate)                                                                                         
</span><span class="methodLine"><i>1192</i>         {                                                                                                              
</span><span class="methodLine"><i>1193</i>             if (signatureOffset <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8799</span>==</span> 0 <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 8014</span>||</span> byteRangeOffset <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8801</span>==</span> 0)                                                          
</span><span class="methodLine"><i>1194</i>             {                                                                                                          
</span><span class="methodLine"><i>1195</i>                 doWriteIncrement();                                                                                    
</span><span class="methodLine"><i>1196</i>             }                                                                                                          
</span><span class="methodLine"><i>1197</i>             else                                                                                                       
</span><span class="methodLine"><i>1198</i>             {                                                                                                          
</span><span class="methodLine"><i>1199</i>                 doWriteSignature();                                                                                    
</span><span class="methodLine"><i>1200</i>             }                                                                                                          
</span><span class="methodLine"><i>1201</i>         }                                                                                                              
</span><span class="outsideLine"><i>1202</i>                                                                                                                        
</span><span class="methodLine"><i>1203</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3215</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1204</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1205</i>                                                                                                                        
</span><span class="outsideLine"><i>1206</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1207</i>     public Object visitFromFloat(COSFloat obj) throws IOException                                                      
</span><span class="methodLine"><i>1208</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1727</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1209</i>         obj.writePDF( getStandardOutput() );                                                                           
</span><span class="methodLine"><i>1210</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3220</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1211</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1212</i>                                                                                                                        
</span><span class="outsideLine"><i>1213</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1214</i>     public Object visitFromInt(COSInteger obj) throws IOException                                                      
</span><span class="methodLine"><i>1215</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1735</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1216</i>         obj.writePDF( getStandardOutput() );                                                                           
</span><span class="methodLine"><i>1217</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3225</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1218</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1219</i>                                                                                                                        
</span><span class="outsideLine"><i>1220</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1221</i>     public Object visitFromName(COSName obj) throws IOException                                                        
</span><span class="methodLine"><i>1222</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1743</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1223</i>         obj.writePDF( getStandardOutput() );                                                                           
</span><span class="methodLine"><i>1224</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3230</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1225</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1226</i>                                                                                                                        
</span><span class="outsideLine"><i>1227</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1228</i>     public Object visitFromNull(COSNull obj) throws IOException                                                        
</span><span class="methodLine"><i>1229</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1751</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1230</i>         obj.writePDF(getStandardOutput());                                                                             
</span><span class="methodLine"><i>1231</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3235</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1232</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1233</i>                                                                                                                        
</span><span class="outsideLine"><i>1234</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1235</i>      * visitFromObjRef method comment.                                                                                 
</span><span class="outsideLine"><i>1236</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1237</i>      * @param obj The object that is being visited.                                                                    
</span><span class="outsideLine"><i>1238</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1239</i>      * @throws IOException If there is an exception while visiting this object.                                        
</span><span class="outsideLine"><i>1240</i>      */                                                                                                                
</span><span class="outsideLine"><i>1241</i>     public void writeReference(COSBase obj) throws IOException                                                         
</span><span class="methodLine"><i>1242</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1758</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1243</i>         COSObjectKey key = getObjectKey(obj);                                                                          
</span><span class="methodLine"><i>1244</i>         getStandardOutput().write(String.valueOf(key.getNumber()).getBytes(Charsets.ISO_8859_1));                      
</span><span class="methodLine"><i>1245</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>1246</i>         getStandardOutput().write(String.valueOf(key.getGeneration()).getBytes(Charsets.ISO_8859_1));                  
</span><span class="methodLine"><i>1247</i>         getStandardOutput().write(SPACE);                                                                              
</span><span class="methodLine"><i>1248</i>         getStandardOutput().write(REFERENCE);                                                                          
</span><span class="methodLine"><i>1249</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1250</i>                                                                                                                        
</span><span class="outsideLine"><i>1251</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1252</i>     public Object visitFromStream(COSStream obj) throws IOException                                                    
</span><span class="methodLine"><i>1253</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1766</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1254</i>         if (willEncrypt)                                                                                               
</span><span class="methodLine"><i>1255</i>         {                                                                                                              
</span><span class="methodLine"><i>1256</i>             pdDocument.getEncryption().getSecurityHandler()                                                            
</span><span class="methodLine"><i>1257</i>                 .encryptStream(obj, currentObjectKey.getNumber(), currentObjectKey.getGeneration());                   
</span><span class="methodLine"><i>1258</i>         }                                                                                                              
</span><span class="outsideLine"><i>1259</i>                                                                                                                        
</span><span class="methodLine"><i>1260</i>         InputStream input = null;                                                                                      
</span><span class="methodLine"><i>1261</i>         try                                                                                                            
</span><span class="methodLine"><i>1262</i>         {                                                                                                              
</span><span class="outsideLine"><i>1263</i>             // write the stream content                                                                                
</span><span class="methodLine"><i>1264</i>             visitFromDictionary(obj);                                                                                  
</span><span class="methodLine"><i>1265</i>             getStandardOutput().write(STREAM);                                                                         
</span><span class="methodLine"><i>1266</i>             getStandardOutput().writeCRLF();                                                                           
</span><span class="outsideLine"><i>1267</i>                                                                                                                        
</span><span class="methodLine"><i>1268</i>             input = obj.createRawInputStream();                                                                        
</span><span class="methodLine"><i>1269</i>             IOUtils.copy(input, getStandardOutput());                                                                  
</span><span class="outsideLine"><i>1270</i>                                                                                                                        
</span><span class="methodLine"><i>1271</i>             getStandardOutput().writeCRLF();                                                                           
</span><span class="methodLine"><i>1272</i>             getStandardOutput().write(ENDSTREAM);                                                                      
</span><span class="methodLine"><i>1273</i>             getStandardOutput().writeEOL();                                                                            
</span><span class="methodLine"><i>1274</i>             <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 5442</span>return null;</span>                                                                                               
</span><span class="methodLine"><i>1275</i>         }                                                                                                              
</span><span class="methodLine"><i>1276</i>         finally                                                                                                        
</span><span class="methodLine"><i>1277</i>         {                                                                                                              
</span><span class="methodLine"><i>1278</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 8078</span>input <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8078</span>!=</span> null</span>)                                                                                         
</span><span class="methodLine"><i>1279</i>             {                                                                                                          
</span><span class="methodLine"><i>1280</i>                 input.close();                                                                                         
</span><span class="methodLine"><i>1281</i>             }                                                                                                          
</span><span class="methodLine"><i>1282</i>         }                                                                                                              
</span><span class="methodLine"><i>1283</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1284</i>                                                                                                                        
</span><span class="outsideLine"><i>1285</i>     @Override                                                                                                          
</span><span class="outsideLine"><i>1286</i>     public Object visitFromString(COSString obj) throws IOException                                                    
</span><span class="methodLine"><i>1287</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1774</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1288</i>         if (willEncrypt)                                                                                               
</span><span class="methodLine"><i>1289</i>         {                                                                                                              
</span><span class="methodLine"><i>1290</i>             pdDocument.getEncryption().getSecurityHandler().encryptString(                                             
</span><span class="methodLine"><i>1291</i>                     obj,                                                                                               
</span><span class="methodLine"><i>1292</i>                     currentObjectKey.getNumber(),                                                                      
</span><span class="methodLine"><i>1293</i>                     currentObjectKey.getGeneration());                                                                 
</span><span class="methodLine"><i>1294</i>         }                                                                                                              
</span><span class="methodLine"><i>1295</i>         COSWriter.writeString(obj, getStandardOutput());                                                               
</span><span class="methodLine"><i>1296</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3255</span>return null;</span>                                                                                                   
</span><span class="methodLine"><i>1297</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1298</i>                                                                                                                        
</span><span class="outsideLine"><i>1299</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1300</i>      * This will write the pdf document.                                                                               
</span><span class="outsideLine"><i>1301</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1302</i>      * @throws IOException If an error occurs while generating the data.                                               
</span><span class="outsideLine"><i>1303</i>      * @param doc The document to write.                                                                               
</span><span class="outsideLine"><i>1304</i>      */                                                                                                                
</span><span class="outsideLine"><i>1305</i>     public void write(COSDocument doc) throws IOException                                                              
</span><span class="methodLine"><i>1306</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1781</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1307</i>         PDDocument pdDoc = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8086</span>new PDDocument( doc )</span>;                                                                      
</span><span class="methodLine"><i>1308</i>         write( pdDoc );                                                                                                
</span><span class="methodLine"><i>1309</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1310</i>                                                                                                                        
</span><span class="outsideLine"><i>1311</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1312</i>      * This will write the pdf document. If signature should be created externally,                                    
</span><span class="outsideLine"><i>1313</i>      * {@link #writeExternalSignature(byte[])} should be invoked to set signature after calling this                   
</span><span class="outsideLine"><i>1314</i>      * method.                                                                                                         
</span><span class="outsideLine"><i>1315</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1316</i>      * @param doc The document to write.                                                                               
</span><span class="outsideLine"><i>1317</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1318</i>      * @throws IOException If an error occurs while generating the data.                                               
</span><span class="outsideLine"><i>1319</i>      */                                                                                                                
</span><span class="outsideLine"><i>1320</i>     public void write(PDDocument doc) throws IOException                                                               
</span><span class="methodLine"><i>1321</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1788</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1322</i>         write(doc, null);                                                                                              
</span><span class="methodLine"><i>1323</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1324</i>                                                                                                                        
</span><span class="outsideLine"><i>1325</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1326</i>      * This will write the pdf document. If signature should be created externally,                                    
</span><span class="outsideLine"><i>1327</i>      * {@link #writeExternalSignature(byte[])} should be invoked to set signature after calling this                   
</span><span class="outsideLine"><i>1328</i>      * method.                                                                                                         
</span><span class="outsideLine"><i>1329</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1330</i>      * @param doc The document to write.                                                                               
</span><span class="outsideLine"><i>1331</i>      * @param signInterface class to be used for signing; {@code null} if external signing would be                    
</span><span class="outsideLine"><i>1332</i>      * performed or there will be no signing at all                                                                    
</span><span class="outsideLine"><i>1333</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1334</i>      * @throws IOException If an error occurs while generating the data.                                               
</span><span class="outsideLine"><i>1335</i>      * @throws IllegalStateException If the document has an encryption dictionary but no protection                    
</span><span class="outsideLine"><i>1336</i>      * policy.                                                                                                         
</span><span class="outsideLine"><i>1337</i>      */                                                                                                                
</span><span class="outsideLine"><i>1338</i>     public void write(PDDocument doc, SignatureInterface signInterface) throws IOException                             
</span><span class="methodLine"><i>1339</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1795</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1340</i>         Long idTime = <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 8090</span>doc.getDocumentId() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8090</span>==</span> null</span> ? System.currentTimeMillis() :                                       
</span><span class="methodLine"><i>1341</i>                                                     doc.getDocumentId();                                               
</span><span class="outsideLine"><i>1342</i>                                                                                                                        
</span><span class="methodLine"><i>1343</i>         pdDocument = doc;                                                                                              
</span><span class="methodLine"><i>1344</i>         signatureInterface = signInterface;                                                                            
</span><span class="outsideLine"><i>1345</i>                                                                                                                        
</span><span class="methodLine"><i>1346</i>         if(incrementalUpdate)                                                                                          
</span><span class="methodLine"><i>1347</i>         {                                                                                                              
</span><span class="methodLine"><i>1348</i>             prepareIncrement(doc);                                                                                     
</span><span class="methodLine"><i>1349</i>         }                                                                                                              
</span><span class="outsideLine"><i>1350</i>                                                                                                                        
</span><span class="outsideLine"><i>1351</i>         // if the document says we should remove encryption, then we shouldn't encrypt                                 
</span><span class="methodLine"><i>1352</i>         if(doc.isAllSecurityToBeRemoved())                                                                             
</span><span class="methodLine"><i>1353</i>         {                                                                                                              
</span><span class="methodLine"><i>1354</i>             willEncrypt = false;                                                                                       
</span><span class="outsideLine"><i>1355</i>             // also need to get rid of the "Encrypt" in the trailer so readers                                         
</span><span class="outsideLine"><i>1356</i>             // don't try to decrypt a document which is not encrypted                                                  
</span><span class="methodLine"><i>1357</i>             COSDocument cosDoc = doc.getDocument();                                                                    
</span><span class="methodLine"><i>1358</i>             COSDictionary trailer = cosDoc.getTrailer();                                                               
</span><span class="methodLine"><i>1359</i>             trailer.removeItem(COSName.ENCRYPT);                                                                       
</span><span class="methodLine"><i>1360</i>         }                                                                                                              
</span><span class="methodLine"><i>1361</i>         else                                                                                                           
</span><span class="methodLine"><i>1362</i>         {                                                                                                              
</span><span class="methodLine"><i>1363</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 8104</span>pdDocument.getEncryption() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8104</span>!=</span> null</span>)                                                                    
</span><span class="methodLine"><i>1364</i>             {                                                                                                          
</span><span class="methodLine"><i>1365</i>                 if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 10730</span>!</span>incrementalUpdate)                                                                                
</span><span class="methodLine"><i>1366</i>                 {                                                                                                      
</span><span class="methodLine"><i>1367</i>                     SecurityHandler securityHandler = pdDocument.getEncryption().getSecurityHandler();                 
</span><span class="methodLine"><i>1368</i>                     if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 12068</span>!</span>securityHandler.hasProtectionPolicy())                                                        
</span><span class="methodLine"><i>1369</i>                     {                                                                                                  
</span><span class="methodLine"><i>1370</i>                         throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 12743</span>new IllegalStateException("PDF contains an encryption dictionary, please remove it with "
</span><span class="methodLine"><i>1371</i>                                 + "setAllSecurityToBeRemoved() or set a protection policy with protect()")</span>;            
</span><span class="methodLine"><i>1372</i>                     }                                                                                                  
</span><span class="methodLine"><i>1373</i>                     securityHandler.prepareDocumentForEncryption(pdDocument);                                          
</span><span class="methodLine"><i>1374</i>                 }                                                                                                      
</span><span class="methodLine"><i>1375</i>                 willEncrypt = true;                                                                                    
</span><span class="methodLine"><i>1376</i>             }                                                                                                          
</span><span class="methodLine"><i>1377</i>             else                                                                                                       
</span><span class="methodLine"><i>1378</i>             {                                                                                                          
</span><span class="methodLine"><i>1379</i>                 willEncrypt = false;                                                                                   
</span><span class="methodLine"><i>1380</i>             }                                                                                                          
</span><span class="methodLine"><i>1381</i>         }                                                                                                              
</span><span class="outsideLine"><i>1382</i>                                                                                                                        
</span><span class="methodLine"><i>1383</i>         COSDocument cosDoc = pdDocument.getDocument();                                                                 
</span><span class="methodLine"><i>1384</i>         COSDictionary trailer = cosDoc.getTrailer();                                                                   
</span><span class="methodLine"><i>1385</i>         COSArray idArray = null;                                                                                       
</span><span class="methodLine"><i>1386</i>         boolean missingID = true;                                                                                      
</span><span class="methodLine"><i>1387</i>         COSBase base = trailer.getDictionaryObject(COSName.ID);                                                        
</span><span class="methodLine"><i>1388</i>         if (base instanceof COSArray)                                                                                  
</span><span class="methodLine"><i>1389</i>         {                                                                                                              
</span><span class="methodLine"><i>1390</i>             idArray = (COSArray) base;                                                                                 
</span><span class="methodLine"><i>1391</i>             if (idArray.size() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8122</span>==</span> 2)                                                                                   
</span><span class="methodLine"><i>1392</i>             {                                                                                                          
</span><span class="methodLine"><i>1393</i>                 missingID = false;                                                                                     
</span><span class="methodLine"><i>1394</i>             }                                                                                                          
</span><span class="methodLine"><i>1395</i>         }                                                                                                              
</span><span class="outsideLine"><i>1396</i>         // check for an existing documentID                                                                            
</span><span class="methodLine"><i>1397</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5506</span>idArray <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5506</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4577</span>&&</span> idArray.size() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5508</span>==</span> 2)                                                                    
</span><span class="methodLine"><i>1398</i>         {                                                                                                              
</span><span class="methodLine"><i>1399</i>             missingID = false;                                                                                         
</span><span class="methodLine"><i>1400</i>         }                                                                                                              
</span><span class="methodLine"><i>1401</i>         if( missingID <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4581</span>||</span> incrementalUpdate)                                                                            
</span><span class="methodLine"><i>1402</i>         {                                                                                                              
</span><span class="methodLine"><i>1403</i>             MessageDigest md5;                                                                                         
</span><span class="methodLine"><i>1404</i>             try                                                                                                        
</span><span class="methodLine"><i>1405</i>             {                                                                                                          
</span><span class="methodLine"><i>1406</i>                 md5 = MessageDigest.getInstance("MD5");                                                                
</span><span class="methodLine"><i>1407</i>             }                                                                                                          
</span><span class="methodLine"><i>1408</i>             catch (NoSuchAlgorithmException e)                                                                         
</span><span class="methodLine"><i>1409</i>             {                                                                                                          
</span><span class="outsideLine"><i>1410</i>                 // should never happen                                                                                 
</span><span class="methodLine"><i>1411</i>                 throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10746</span>new RuntimeException(e)</span>;                                                                         
</span><span class="methodLine"><i>1412</i>             }                                                                                                          
</span><span class="outsideLine"><i>1413</i>                                                                                                                        
</span><span class="outsideLine"><i>1414</i>             // algorithm says to use time/path/size/values in doc to generate the id.                                  
</span><span class="outsideLine"><i>1415</i>             // we don't have path or size, so do the best we can                                                       
</span><span class="methodLine"><i>1416</i>             md5.update( Long.toString(idTime).getBytes(Charsets.ISO_8859_1) );                                         
</span><span class="outsideLine"><i>1417</i>                                                                                                                        
</span><span class="methodLine"><i>1418</i>             COSDictionary info = trailer.getCOSDictionary(COSName.INFO);                                               
</span><span class="methodLine"><i>1419</i>             if( <span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 8147</span>info <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 8147</span>!=</span> null</span> )                                                                                         
</span><span class="methodLine"><i>1420</i>             {                                                                                                          
</span><span class="methodLine"><i>1421</i>                 for (COSBase cosBase : info.getValues())                                                               
</span><span class="methodLine"><i>1422</i>                 {                                                                                                      
</span><span class="methodLine"><i>1423</i>                     md5.update(cosBase.toString().getBytes(Charsets.ISO_8859_1));                                      
</span><span class="methodLine"><i>1424</i>                 }                                                                                                      
</span><span class="methodLine"><i>1425</i>             }                                                                                                          
</span><span class="outsideLine"><i>1426</i>             // reuse origin documentID if available as first value                                                     
</span><span class="methodLine"><i>1427</i>             COSString firstID = missingID ? <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 11186</span>new COSString( md5.digest() )</span> : (COSString)idArray.get(0);                 
</span><span class="outsideLine"><i>1428</i>             // it's ok to use the same ID for the second part if the ID is created for the first time                  
</span><span class="methodLine"><i>1429</i>             COSString secondID = missingID ? firstID : <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 11194</span>new COSString( md5.digest() )</span>;                                  
</span><span class="methodLine"><i>1430</i>             idArray = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9683</span>new COSArray()</span>;                                                                                  
</span><span class="methodLine"><i>1431</i>             idArray.add( firstID );                                                                                    
</span><span class="methodLine"><i>1432</i>             idArray.add( secondID );                                                                                   
</span><span class="methodLine"><i>1433</i>             trailer.setItem(COSName.ID, idArray);                                                                      
</span><span class="methodLine"><i>1434</i>         }                                                                                                              
</span><span class="methodLine"><i>1435</i>         cosDoc.accept(this);                                                                                           
</span><span class="methodLine"><i>1436</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1437</i>                                                                                                                        
</span><span class="outsideLine"><i>1438</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1439</i>      * This will write the fdf document.                                                                               
</span><span class="outsideLine"><i>1440</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1441</i>      * @param doc The document to write.                                                                               
</span><span class="outsideLine"><i>1442</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1443</i>      * @throws IOException If an error occurs while generating the data.                                               
</span><span class="outsideLine"><i>1444</i>      */                                                                                                                
</span><span class="outsideLine"><i>1445</i>     public void write(FDFDocument doc) throws IOException                                                              
</span><span class="methodLine"><i>1446</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1802</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1447</i>         fdfDocument = doc;                                                                                             
</span><span class="methodLine"><i>1448</i>         willEncrypt = false;                                                                                           
</span><span class="methodLine"><i>1449</i>         COSDocument cosDoc = fdfDocument.getDocument();                                                                
</span><span class="methodLine"><i>1450</i>         cosDoc.accept(this);                                                                                           
</span><span class="methodLine"><i>1451</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1452</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1453</i>      * This will output the given byte getString as a PDF object.                                                      
</span><span class="outsideLine"><i>1454</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1455</i>      * @param string COSString to be written                                                                           
</span><span class="outsideLine"><i>1456</i>      * @param output The stream to write to.                                                                           
</span><span class="outsideLine"><i>1457</i>      * @throws IOException If there is an error writing to the stream.                                                 
</span><span class="outsideLine"><i>1458</i>      */                                                                                                                
</span><span class="outsideLine"><i>1459</i>     public static void writeString(COSString string, OutputStream output) throws IOException                           
</span><span class="methodLine"><i>1460</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1810</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1461</i>         writeString(string.getBytes(), string.getForceHexForm(), output);                                              
</span><span class="methodLine"><i>1462</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1463</i>                                                                                                                        
</span><span class="outsideLine"><i>1464</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1465</i>      * This will output the given text/byte getString as a PDF object.                                                 
</span><span class="outsideLine"><i>1466</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1467</i>      * @param bytes byte array representation of a string to be written                                                
</span><span class="outsideLine"><i>1468</i>      * @param output The stream to write to.                                                                           
</span><span class="outsideLine"><i>1469</i>      * @throws IOException If there is an error writing to the stream.                                                 
</span><span class="outsideLine"><i>1470</i>      */                                                                                                                
</span><span class="outsideLine"><i>1471</i>     public static void writeString(byte[] bytes, OutputStream output) throws IOException                               
</span><span class="methodLine"><i>1472</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1818</span>{</span>                                                                                                                  
</span><span class="methodLine"><i>1473</i>         writeString(bytes, false, output);                                                                             
</span><span class="methodLine"><i>1474</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1475</i>                                                                                                                        
</span><span class="outsideLine"><i>1476</i>     /**                                                                                                                
</span><span class="outsideLine"><i>1477</i>      * This will output the given text/byte string as a PDF object.                                                    
</span><span class="outsideLine"><i>1478</i>      *                                                                                                                 
</span><span class="outsideLine"><i>1479</i>      * @param output The stream to write to.                                                                           
</span><span class="outsideLine"><i>1480</i>      * @throws IOException If there is an error writing to the stream.                                                 
</span><span class="outsideLine"><i>1481</i>      */                                                                                                                
</span><span class="outsideLine"><i>1482</i>     private static void writeString(byte[] bytes, boolean forceHex, OutputStream output)                               
</span><span class="outsideLine"><i>1483</i>             throws IOException                                                                                         
</span><span class="methodLine"><i>1484</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1826</span>{</span>                                                                                                                  
</span><span class="outsideLine"><i>1485</i>         // check for non-ASCII characters                                                                              
</span><span class="methodLine"><i>1486</i>         boolean isASCII = true;                                                                                        
</span><span class="methodLine"><i>1487</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4603</span>!</span>forceHex)                                                                                                 
</span><span class="methodLine"><i>1488</i>         {                                                                                                              
</span><span class="methodLine"><i>1489</i>             for (byte b : bytes)                                                                                       
</span><span class="methodLine"><i>1490</i>             {                                                                                                          
</span><span class="outsideLine"><i>1491</i>                 // if the byte is negative then it is an eight bit byte and is outside the ASCII range                 
</span><span class="methodLine"><i>1492</i>                 if (b <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: >= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 10779</span><</span> 0)                                                                                             
</span><span class="methodLine"><i>1493</i>                 {                                                                                                      
</span><span class="methodLine"><i>1494</i>                     isASCII = false;                                                                                   
</span><span class="methodLine"><i>1495</i>                     break;                                                                                             
</span><span class="methodLine"><i>1496</i>                 }                                                                                                      
</span><span class="outsideLine"><i>1497</i>                 // PDFBOX-3107 EOL markers within a string are troublesome                                             
</span><span class="methodLine"><i>1498</i>                 if (b <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 11205</span>==</span> 0x0d <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 10783</span>||</span> b <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 11207</span>==</span> 0x0a)                                                                            
</span><span class="methodLine"><i>1499</i>                 {                                                                                                      
</span><span class="methodLine"><i>1500</i>                     isASCII = false;                                                                                   
</span><span class="methodLine"><i>1501</i>                     break;                                                                                             
</span><span class="methodLine"><i>1502</i>                 }                                                                                                      
</span><span class="methodLine"><i>1503</i>             }                                                                                                          
</span><span class="methodLine"><i>1504</i>         }                                                                                                              
</span><span class="outsideLine"><i>1505</i>                                                                                                                        
</span><span class="methodLine"><i>1506</i>         if (isASCII <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4607</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 5561</span>!</span>forceHex)                                                                                      
</span><span class="methodLine"><i>1507</i>         {                                                                                                              
</span><span class="outsideLine"><i>1508</i>             // write ASCII string                                                                                      
</span><span class="methodLine"><i>1509</i>             output.write('(');                                                                                         
</span><span class="methodLine"><i>1510</i>             for (byte b : bytes)                                                                                       
</span><span class="methodLine"><i>1511</i>             {                                                                                                          
</span><span class="methodLine"><i>1512</i>                 switch (b)                                                                                             
</span><span class="methodLine"><i>1513</i>                 {                                                                                                      
</span><span class="methodLine"><i>1514</i>                     case '(':                                                                                          
</span><span class="methodLine"><i>1515</i>                     case ')':                                                                                          
</span><span class="methodLine"><i>1516</i>                     case '\\':                                                                                         
</span><span class="methodLine"><i>1517</i>                         output.write('\\');                                                                            
</span><span class="methodLine"><i>1518</i>                         output.write(b);                                                                               
</span><span class="methodLine"><i>1519</i>                         break;                                                                                         
</span><span class="methodLine"><i>1520</i>                     default:                                                                                           
</span><span class="methodLine"><i>1521</i>                         output.write(b);                                                                               
</span><span class="methodLine"><i>1522</i>                         break;                                                                                         
</span><span class="methodLine"><i>1523</i>                 }                                                                                                      
</span><span class="methodLine"><i>1524</i>             }                                                                                                          
</span><span class="methodLine"><i>1525</i>             output.write(')');                                                                                         
</span><span class="methodLine"><i>1526</i>         }                                                                                                              
</span><span class="methodLine"><i>1527</i>         else                                                                                                           
</span><span class="methodLine"><i>1528</i>         {                                                                                                              
</span><span class="outsideLine"><i>1529</i>             // write hex string                                                                                        
</span><span class="methodLine"><i>1530</i>             output.write('<');                                                                                         
</span><span class="methodLine"><i>1531</i>             Hex.writeHexBytes(bytes, output);                                                                          
</span><span class="methodLine"><i>1532</i>             output.write('>');                                                                                         
</span><span class="methodLine"><i>1533</i>         }                                                                                                              
</span><span class="methodLine"><i>1534</i>     }</span>                                                                                                                  
</span><span class="outsideLine"><i>1535</i> }                                                                                                                      
</span><span class="outsideLine"><i>1536</i>                                                                                                                        </pre></div><footer><p style="font-size: small">Report generated by LittleDarwin 0.10.7 </p></footer></body></html>